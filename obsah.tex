%=========================================================================
% (c) Michal Bidlo, Bohuslav Køena, 2008

\chapter{Úvod}

%zpùsoby testovani webovych sluzeb - funcionalni testovani, 



\chapter{Základní pojmy}
V této kapitole je popsána vìt¹ina dùle¾itých pojmù a zkratek, které se vyskytují dále v práci nebo jsou dùle¾ité pro objasnìní nìkterého z pou¾itých principù. Nejdøíve budou popsány dvì základní architektury, kterých týká celá tato práce. Dále budou popsány principy transakcí a jejich roz¹íøení na distribuované systémy. V poslední èásti základních pojmù jsou popsány souèásti platformy programovacího jazyka Java.

\subsubsection*{Hypermédia}
Pojem hypermédia \cite{hypermedia} poprvé pou¾il Ted Nelson jako zobecnìní pojmu hypertext. Hypertext jsou textové dokumenty propojené pomocí odkazù, zatímco hypermédia roz¹iøuje pojem hypertext na jakoukoliv formu média. Tedy jsou to média propojené pomocí odkazù.

\subsubsection*{Serializace a Deserializace}
Postup, pøi kterém je objekt nebo datová struktura pøeveden do urèitého formátu \cite{serial}. Tento formát musí umo¾òovat ulo¾ení datové struktury napø. na pevný disk nebo jej odeslat pomocí sítì na vzdálený stroj. Deserializace je inverzní postup, pøi kterém je datová struktura pøevedena z serializované podoby zpìt do své pùvodní.


\subsubsection*{HTML}
HTML je zkratka pro Hypertext Markup Language \cite{HTML}, co¾ je znaèkovací jazyk pro vytváøení strukturovaných dokumentù na webu. HTML umo¾òuje vkládat sémantické znaèky, které jsou zpravidla párové. Mezi páry znaèek tzv. tagù je umístìn text, který je na základì znaèek interpretován webovým prohlí¾eèem

\subsubsection*{HTTP}
HTTP je zkratka pro Hypertext Transfer Protocol \cite{HTTP}. Je to protokol pro výmìnu hypertextových dokumentù ve formátu HTML. Výmìna dokumentù probíhá formou dotaz-odpovìï. 

\subsubsection*{URI} 
Universal Resource Identifier zkratka pro jednotný identifikátor zdroje \cite{URI}. Je textový øetìzec, který má definovanou strukturu. Slou¾í k identifikaci zdroje v poèítaèových sítích, zejména internetu. Pod pojmem zdroj je v tomto kontextu my¹len dokument nebo slu¾ba. URI je slo¾eno z øetìzce umístìní zdroje (URL, Universal Resource Locator) a øetìzce názvu zdroje (URN, Univesal Resource Name).


\subsubsection*{XML}
XML je zkratka pro Extensible Markup Language \cite{XML}. Je to obecný znaèkovací jazyk, kterým je mo¾no vytváøet konkrétní znaèkovací jazyky. Pou¾ívá se pro pøená¹ení dat mezi webovými aplikacemi a vytváøení dokumentù. Pøi vytváøení dokumentù se pomocí znaèek oznaèuje význam textu, co¾ hraje velkou roli napø. pøi vyhledávání informací v dokumentu.

\subsubsection*{SOAP} 
SOAP je pùvodnì zkratka pro Simple Object Acsess Protocol, ale od verze 1.2 se pou¾ívá pouze SOAP jako samostatný pojem \cite{SOAP}. Specifikuje protokol pro výmìnu strukturovaných a typovaných informací v decentralizovaných a distribuovaných sítích. Pou¾ívá XML pro definování sady funkcí pro vytváøení a výmìnu zpráv nad rùznými podpùrnými protokoly. SOAP byl vyvinut tak, aby byl nezávislý na transportních protokolech. 


\subsubsection*{REST}
Zkratka REST znamená REpresentation State Transfer. Oznaèuje architektonický styl pro hypermediální distribuované systémy. V tìchto systémech jsou ulo¾eny dokumenty nebo slu¾by, které jsou identifikovány pomocí URI.  REST není pøímo svázán s konkrétním komunikaèním protokolem. Jeliko¾ HTTP protokol nejlépe vyhovuje principùm REST , je s tímto stylem ve vìt¹inì pøípadù spojován.


\subsubsection*{Volnì svázaný systém}
\label{LC}Volnì svázané (loosely coupled)\cite{SOA} systémy obsahují na sobì nezávislé komponenty, které spolu komunikují a tak vytváøejí po¾adovaný systém. Nezávislost tìchto komponent spoèívá v mo¾nosti jejich obmìny. Ve volnì svázaném systému se mohou jednotlivé komponenty uvnitø mìnit (verze, implementace, atd.) ani¾ by to negativnì zasáhlo daný systém.

\subsubsection*{Tìsnì svázaný systém} 
 Tìsnì svázané (tightly coupled)\cite{SOA} systémy obsahují na sobì závislé komponenty, jejich¾ implementace je spojuje dohromady. V tìsnì vázaných systémech si nemù¾eme dovolit mìnit (implementace, verze, atd.) pouze jednu komponentu, ani¾ by to mìlo negativní následky na chod ostatních komponent nebo systému jako celku.

\subsubsection*{Otevøený software}
Otevøený software (open-source software)\cite{OSI} je software s otevøeným zdrojovým kódem. Otevøenost znamená mo¾nost zdrojový kód vyu¾ívat pøi splnìní urèitých podmínek.

\newpage






\section{Architektura orientovaná na slu¾by}
Architektura orientovaná na slu¾by (Services oriented architecture, SOA) \cite{SOA} \label{SOA} je sada principù a postupù pro návrh a vývoj softwaru. SOA se zamìøuje na pøesnì definované softwarové komponenty (èásti poèítaèových systému, datové struktury, apod.), které mohou být pou¾ity vícekrát, pro více úèelù a v kontextu SOA sem jim øíká slu¾by. Nyní si si uká¾eme hlavní principy a postupy, které se pou¾ívají pøi vytváøení slu¾eb v rámci SOA.

\subsection*{Zapouzdøení operace}
Pøi vytváøení systému obsahujících slu¾by mù¾e být rozsah zapouzdøení men¹í i vìt¹í. Slu¾ba mù¾e zapouzdøit jednu operaci v rámci systému nebo operaci, která reprezentuje celý systém.

\subsection*{Vztah mezi slu¾bami}
Jednotlivé slu¾by mohou být vyu¾ívány jinými slu¾bami nebo programy. Aby mohly slu¾by a programy mezi sebou komunikovat, musí o sobì vìdìt. Toto povìdomí je realizováno pomocí popisu slu¾by. V popisu slu¾by je uveden název slu¾by a druh dat, které slu¾ba oèekává a vrací.

\subsection*{Komunikace mezi slu¾bami}
Slu¾by komunikují pomocí zpráv. Jakmile je zpráva odeslána, slu¾ba nad ní ztrácí kontrolu. Podle SOA by mìla být zpráva nezávislou komunikaèní jednotkou, a tak zastávat stejnou pozici pøi komunikaci jako slu¾ba. Jinými slovy to znamená, ¾e zpráva si sama urèí slu¾bu, ke které bude doruèena. Abychom toho dosáhli, je nutné vybavit zprávu patøiènou inteligencí.


\noindent Jedním z mo¾ných pøístupù SOA, kterým lze SOA implementovat, jsou webové slu¾by. Nutno poznamenat, ¾e ne v¹echny systémy implementované pomocí webových slu¾eb splòují koncept SOA a zároveò v systému vytvoøeném pomocí SOA konceptu nemusí být obsa¾eny webové slu¾by. Tedy SOA a webové slu¾by nejsou synonyma, ale velmi èasto spojované pojmy.




\subsection*{SOAP webové slu¾by}
Základem pro SOAP webové slu¾eby je SOAP protokol. SOAP je navr¾en jako bezstavový protokol. Pou¾ívá jednocestný zpùsob odesílání zpráv (one-way MEP, Message Exchange Pattern), ale je mo¾no jej pøizpùsobit k dal¹ím zpùsobùm odesílání zpráv jako napø. ¾ádost/odpovìï, ¾ádost/více odpovìdí. SOAP protokol je mo¾no pou¾ívat na libovolné platformì s libovolným programovacím jazykem. 

Hlavními specifikacemi pro SOAP webové slu¾by je soubor specifikací s prefixem WS-. Tento soubor specifikací zahrnuje dal¹í funkcionality, které byly vyvinuty nad SOAP protokolem. Patøí mezi nì napø. transakèní zpracování, bezpeènost, spolehlivost atd. Dal¹ími dùle¾itými  technologiemi jsou jazyk pro popis definice webové slu¾by (WSDL, Web Service Definition Language) a registr pro popis a lokalizaci webových slu¾eb (UDDI, Universal Description and Discovery Integration). Nejdøíve si popí¹eme specifikaci SOAP a po té budou pøedstaveny technologie WSDL a UDDI.
\\\\ 
Specifikace SOAP protokolu je rozdìlena na 4 èásti:

\begin{itemize}
 \item {\bf Model zpracování }\\ 
 Model zpracování pøedstavuje jednotlivé èásti distribuovaného modelu, který je v SOAP pou¾it. Jsou zde popsány druhy uzlù, které vyu¾ívá distribuovaný model, pou¾ité zpùsoby výmìny zpráv mezi uzly a dal¹í nezbytnosti, které jsou potøeba pro zpracování SOAP zpráv.
 \item {\bf Model roz¹íøení }\\ 
SOAP protokol byl vytvoøen jako velmi dobøe roz¹íøitelný. Tento model popisuje zpùsob jak mají být zpracovány nové funkcionality a roz¹íøení SOAP protokolu.
\item {\bf Spojení s protokolem pro pøenos zpráv }\\ 
SOAP protokol není závislý na pøenosovém protokolu a mù¾e tak být spjat s rùznými protokoly. Jako nejvhodnìj¹í kandidáti byly vybrány protokoly HTTP a protokol pro elektronickou po¹tu (SMTP, Simple Mail Transport Protocol). Pro mnohem roz¹íøenìj¹í pou¾ití se dnes hlavnì pou¾ívá protokol HTTP. Pou¾ívá se také pro jeho snadný prùchod pøes sí»ová zabezpeèení (firewall apod.). 
\item {\bf Vytváøení zpráv }\\ 
Zprávy jsou v SOAP protokolu definovány jako XML dokument. Tento formát má své výhody i nevýhody. XML je výhodné, proto¾e odpadají problémy s pøenositelnosti mezi systémy, proto¾e se jedná o textový dokument. Právì zpracování XML dokumentu pøiná¹í problémy s výkoností, proto¾e zpracování textových dokumentù pøiná¹í svá úskalí.
\end{itemize}


\subsubsection*{SOAP zpráva}
Jeliko¾ slu¾by mezi sebou komunikují pomocí zpráv, je nutné, aby zprávy mìly jednotný formát a slu¾by pou¾ívaly stejný transportní protokol. Formát zprávy musí být flexibilní a roz¹íøitelný. Z obrázku \ref{fig:SOAPMess} je patrné, ¾e SOAP zpráva se skládá ze 4 èástí:
\begin{itemize}
 \item {\bf Obálka }\\ 
 Jak ji¾ název èásti napovídá, obálka se dá charakterizovat jako kontejner, který volitelnì obsahuje hlavièku a povinnì musí obsahovat tìlo zprávy. 
 \item {\bf Hlavièka}\\ 
 K dosa¾ení zmínìné inteligence zprávy se vyu¾ívá obsahu hlavièky SOAP zprávy. Obsah je slo¾en z jednotlivých blokù, které mohou nést rùzné druhy informace související s doruèováním zprávy, zpracování tìla zpráv, bezpeèností apod. Sémantika jednotlivých blokù není v SOAP specifikována. Ka¾dý blok mù¾e mít rozdílný význam, a tedy i specifikaci. 
 \item {\bf Tìlo}\\ 
  Tìlo zprávy obsahuje odesílaná data, které jsou ve formátu XML. V pøípadì potøeby mù¾e zpráva obsahovat informaci o chybì na stranì pøíjemce. Zpráva s informací o chybì je pak doruèena zpìt odesilateli. 
\item {\bf Pøílohy}\\
SOAP pøíloha umo¾òuje posílat zejména data, která nelze popsat XML dokumentem. Obecnì se jedná o binární data (multimédia, dokumenty, apod.).
\end{itemize}

\begin{figure}[h]
\begin{center}
 \includegraphics[scale=1, bb= 0.0mm 230.0mm 130mm 294mmm]{pic/SOAPZprava.pdf}
\caption{Obecný formát SOAP zprávy.}
\label{fig:SOAPMess}
\end{center}
\end{figure}

\subsubsection*{SOAP obslu¾né rutiny}
SOAP obslu¾né rutiny (SOAP handlers)\cite{JAX-WS} mohou zpracovávat zprávu po pøíchodu a pøed odchodem zprávy. Jeliko¾ se v hlavièce zprávy nacházejí rùzné informace (zpùsob zpracování tìla zprávy, bezpeènostní kontext, transakèní kontext, apod.), které je potøeba zpracovat døíve ne¾ je slu¾ba spu¹tìna, zpráva je nejdøíve zachycena tìmito rutinami a ty vykonají pøíslu¹né operace pøed spu¹tìním slu¾by. SOAP obslu¾né rutiny se mohou nacházet na klientské stranì i na koncové stranì slu¾eb.

Na klientské stranì zpravidla pøidávají informace (bloky hlavièky) do zprávy. Na koncové stranì slu¾eb ètou, pøípadnì odstraòují informace ze zprávy a vykonávají patøièné operace. Obslu¾né rutiny nemusejí být pøítomny vùbec nebo jich mu¾e být i více najednou.

\begin{figure}[h]
\begin{center}
 \includegraphics[scale=0.8, bb= 0.0mm 220.0mm 210mm 294mmm]{pic/SOAPhandler.pdf}
\caption{Pou¾ití SOAP obslu¾né rutiny.}
\label{fig:HANDLER}
\end{center}
\end{figure}

\subsubsection*{Jazyk pro popis slu¾eb}
Popis slu¾by slou¾í jako strojovì zpracovatelný manuál pro zacházení s webovou slu¾bou (WSDL, Web Service Definition Language). WSDL je popisuje webovou slu¾bu pomocí XML dokumentu. WSDL patøí mezi jazyky definující rozhraní (IDL, Interface Definition Language). IDL jazyky slou¾í k pøesnému popsání rozhraní dané softwarové komponenty tak, aby bylo mo¾né jej strojovì zpracovat. Hlavní vlastností IDL jazykù je nezávislost na programovacím jazyku. V praxi to znamená, ¾e pomocí IDL jazyka lze vygenerovat rozhraní pro rùzné programovací jazyky. V pøípadì WSDL se generují rozhraní pro webové slu¾by. WSDL v¹ak neslou¾í pouze ke generování rozhraní, ale také k vyhledávání a rozpoznání webové slu¾by. V pøípadì vyhledání a rozpoznání je mo¾né WSDL dokument analyzovat a rozhodnout, zda-li daná webová slu¾ba odpovídá po¾adavkùm.

WSDL dokument je rozdìlen na abstraktní èást a konkrétní èást. V abstraktní èásti jsou popsány souèásti rozhraní, které nejsou závislé na konkrétních technologiích tzn, datové typy, typy pøená¹ených zpráv. Definice z abstraktní èásti jsou pak pou¾ity pro pøesný popis spojení se slu¾bou a popis slu¾by samotné.

XML struktura WSDL dokumentu zaèíná koøenovým elementem {\it description}, která obsahuje abstraktní souèásti  {\it types},  {\it  interfaces}. V konkretní èásti se pak definice z  {\it types} a {\it  interfaces} pou¾ijí pro souèásti {\it binding}a  {\it  service}. Toto je popis WSDL podle verze 2.0. Pøede¹lá verze obsahuje odli¹nosti v pojmenování a struktuøe jednotlivých elementù. WSDL verze 2.0 je také vhodná pro popis REST webových slu¾eb.
\\\\
Popis jednotlivých souèástí WSDL dokumentu:
\begin{itemize}
\item{\bf Typy}\\
 V souèásti {\it types} jsou definovány pou¾ité datové typy. Je mo¾né pou¾ít rùzné druhy popisu datových typù, ale je doporuèeno a hlavnì se pou¾ívá XML schéma pro definici datových typu (XSD, XML Schema Definition Language). Také je zde popsán formát pøená¹ených zpráv. Je mo¾né tyto definice naèíst z externího zdroje pomocí elementu  {\it import}.
\item{\bf Rozhraní }\\
V souèásti  {\it interfaces} jsou popsány operace, které budou pou¾ity slu¾bou. Zde se jednotlivým operacím pøiøadí vstupní a výstupní zprávy, které jsou definovány v èásti  {\it types}.

\item{\bf Spojení }\\
Souèást  {\it bindings} slou¾í k definici spojení s danou technologii. Obvykle to jsou SOAP a HTTP protokoly. Dále je pak definováno jaký styl SOAP zprávy má být pou¾it. V tomto pøípadì jsou dvì mo¾nosti,  {\it document} nebo  {\it rpc} styl.  Je doporuèeno pou¾ívat  {\it document} styl. Styl  {\it document} nemá strukturální omezení obsahu SOAP zprávy, èili mù¾e to být libovolný XML dokument. Naproti tomu  {\it rpc} styl musí odpovídat pøedepsanému RPC schématu zprávy. Oba styly musí být XML dokumenty, proto mohou být naprosto stejné pouze z vý¹e popsanými omezeními.

\item{\bf Slu¾ba }\\
Souèást  {\it service} je pou¾ita pro konkrétní definici dané slu¾by pomocí vý¹e zmínìných souèástí. Je zde pou¾ito definované spojení a adresa, na které je slu¾ba dostupná.
\end{itemize}
WSDL má samozøejmì mnoho dal¹ích mo¾ností, ale vý¹e uvedené jsou postaèující k vytvoøení plnohodnotné slu¾by. Více informací o WSDL je mo¾no získat v pøíslu¹ných specifikacích.


\subsubsection*{Registr pro popis a nalezení webových slu¾eb - UDDI}
UDDI slou¾í pro ukládání informací o webových slu¾bách. Informace jsou ulo¾eny jako XML dokumenty vìt¹inou v SQL databázích. UDDI se hlavnì pou¾ívá pro vyhledávání webových slu¾eb na základì jejich popisu, aby se potom mohly pou¾ít. Tento centralizovaný zpùsob má za cíl zpøehlednit a usnadnit vyhledání a následné pou¾ití webové slu¾by.

Svého èasu se specifikace UDDI tì¹ila velké popularity a byla hojnì vyu¾ívána a rozvíjena. Vývoj specifikace se v¹ak zastavil pøed nìkolika lety na verzi 3.0. V této dobì velké firmy nabízel veøejné UDDI registry pro zaøazení veøejných webových slu¾eb. Av¹ak z této cesty bylo upu¹tìno a dnes ji¾ veøejných UDDI registrù je velmi málo. UDDI se v¹ak stále pou¾ívá, ale své místo získala tato technologie v privátních sítích a øe¹eních. Pou¾ívá se pøi pou¾ití sbìrnic slu¾eb (ESB, Enterprise Service Bus) a podobných integraèních øe¹eních, kde se automatizují procesy. Zde právì sbìrnice slu¾eb mù¾e dynamicky vyhledat v UDDI registrech  slu¾bu podle po¾adovaných kritérií, a tak vybrat vhodnou slu¾bu k pou¾ití.
\\\\
UDDI registr se skládá ze 3 èástí:
\begin{itemize}
\item {\bf Bílé stránky}\\
V bílých stránkách jsou ulo¾eny informace o poskytovateli slu¾by. Pomocí bílých stránek lze najít slu¾bu napø. podle jména nebo názvu poskytovatele.	
\item {\bf ®luté stránky}\\
Ve ¾lutých stránkách jsou ulo¾eny informace o kategorii poskytované slu¾by. Jeliko¾ poskytovatel mù¾e poskytovat více kategorií slu¾eb, mù¾e se více ¾lutých stránek vztahovat k jedné bílé.
\item {\bf Zelené stránky}\\
V zelených stránkách jsou ulo¾eny technické informace o slu¾bách. Typické informace v zelených stránkách jsou spojení s webovou slu¾bou, adresa slu¾by nebo pøedávané parametry. Jeliko¾ slu¾ba mù¾e definovat více druhù spojení, mohou zelené stránky obsahovat více záznamù k jedné slu¾bì.
\end{itemize}
Jednou s velmi populárních implementací UDDI specifikace je jUDDI, která je pod správou Apache Foundation.









\subsection*{SOA pomocí webových slu¾eb}
Co jsou to webové slu¾by jsme si popsali ji¾ døíve. Nyní se podíváme na jejich strukturu a jak pomocí nich lze implementovat principy SOA.

Zapouzdøení operace do slu¾by je zde realizováno právì pomocí webové slu¾by. Popis slu¾by lze realizovat pomocí WSDL. Komunikace je realizována pomocí SOAP protokolu. SOA pomocí webových slu¾eb obsahuje 3 role :

\begin{itemize}
\item {\bf Poskytovatel slu¾by - Service provider}\\
Je zodpovìdný za popis slu¾by a její spu¹tìní na serveru. Pak je slu¾ba dostupná ze sítì a je mo¾no zaregistrovat její popis v registrech, kde bude k nalezení pro ¾adatele o slu¾bu. Tuto roli lze pøipodobnit k serveru v architektuøe klient-server.
\item{\bf ®adatel o slu¾bu - Service requester }\\
Vyhledá po¾adovanou slu¾bu v jednom nebo více registrech. Po nalezení popisu dané slu¾by se ¾adatel spojí se slu¾bou u poskytovatele a mù¾e ji pou¾ívat. Tuto roli lze pøipodobnit ke klientovi v architektuøe klient-server.
\item{\bf Registr slu¾by - Service registry}\\
Registr vystavuje popisy slu¾eb dostupných od poskytovatelù pro ¾adatele, kteøí v tìchto registrech vyhledávají po¾adované slu¾by. Jakmile je jednou slu¾ba v registru nalezena, není ji¾ tato role potøebná.
\\\\

\end{itemize}
\begin{figure}[h]
\begin{center}
 \includegraphics[bb= 0mm 195mm 150mm 294mm]{pic/soa.pdf}
\caption{Model SOA pomocí  webových slu¾eb.}
\end{center}
\end{figure}
\noindent Tyto role mohou hrát jakékoliv programy nebo uzly v síti. Webové slu¾by také obsahuje tøi operace, které definují vztahy mezi jednotlivými rolemi:
\begin{itemize}
\item{\bf Zveøejnìní }\\
Je vztah operace mezi registrem slu¾eb a poskytovatelem, kdy poskytovatel zveøejní popis slu¾by v registru, a tak ho zpøístupní ¾adatelùm. Konkretní mechanizmus zveøejnìní závisí na implementaci registru. V urèitých pøípadech roli registru pøejímá sama sí», kdy je popis slu¾by zveøejnìn pøímo v pøístupné èásti souborového systému na serveru.
\item{\bf Nalezení }\\
®adatel definuje vlastnosti transakce a podle nich je vyhledána slu¾ba v registrech. Výsledkem hledání je seznam slu¾eb, které odpovídají kriteriím. Nejjednodu¹¹í vyhledávací dotaz je HTTP GET\footnote{ Hypertext transfer protokol - protokol pro pøená¹ení hypertextových HTML dokumentù \\ GET - jedna z metod HTTP pro získání webové stránky klientem ze serveru} bez parametrù, který v¾dy vrátí v¹echny slu¾by, které jsou k dispozici. Pak je na ¾adateli, aby vybral správnou slu¾bu. Pro komplexní registraci a vyhledání slu¾eb se pou¾ívá standardu UDDI . 
\item{\bf Spojení }\\
Ustanovuje vztah klient-server mezi ¾adatelem o slu¾bu a poskytovatelem. Tento vztah mù¾e být dynamický, kdy mohou být za bìhu vybírány jiné implementace dané slu¾by daných kriterii. Také mù¾e být statický, kdy programátor pøímo implementuje zpùsob volání dané slu¾by.
\end{itemize}








\section{REST}
Architektonický styl REST byl navr¾en Roy Fieldingem  v rámci jeho disertaèní práce v roce 2000 \cite{fielding}. REST není architekturou ani technologii. REST je sada omezení, které musí dané øe¹ení obsahovat. REST byl vytvoøen pro prostøedí internetu a webu. REST je orientován na zdroje, kde zdroj pøedstavují po¾adováná data nebo stav daného vzdáleného systému. Tento styl získávání dat je velmi podobný SQL dotazùm, kde také po¾adujeme urèitá data (deklarativní programování). V kontrastu s tímto je SOAP protokol, pomocí kterého jsou na vzdálené stranì vyvolávány procedury (procedurální programování).

Aèkoliv je mo¾né se doèíst o soupeøení a porovnávání mezi SOA a REST, tak hlavní smysl REST je být alternativou k procedurálnímu charakteru SOA architektury. 
\\\\
Nyní se podíváme na základní sadu charakteristik REST:
\begin{itemize}
\item {\bf Architektura klient/server}\\
Zde je klientem u¾ivatelské rozhraní a server je úlo¾i¹tì dat. Díky oddìlení u¾ivatelského rozhraní a serveru má být dosa¾eno lep¹í pøenositelnosti u¾ivatelského rozhraní a lep¹í ¹kálovatelnosti serverové strany.
\item {\bf Bezstavovost}\\
Kontext nesmí být ulo¾en na stranì serveru a odeslaná odpovìï musí být sebe-popisující. Ve¹keré informace o aktuálním sezení jsou ulo¾eny na stranì klienta. Toto omezení má umo¾òovat lep¹í viditelnost, spolehlivost a ¹kálovatelnost. Lep¹í viditelnosti je dosa¾eno, proto¾e monitorovací systémy mohou monitorovat pouze odesílané po¾adavky a pøijímané odpovìdi, kde jsou kompletní informace. Lep¹í spolehlivosti je dosa¾eno díky snadnìj¹í obnovì po chybách, proto¾e na serveru nejsou ulo¾eny kontextové informace. Díky neukládání kontextových informací na serveru je dosa¾eno i lep¹í ¹kálovatelnosti.
\item {\bf Mezi-pamì»}\\
Pro lep¹í výkonnost dotazù by mìla být pou¾ita na stranì klienta mezi-pamì» (cache), která ukládá výsledky ji¾ provedených dotazù. Toto zlep¹ení výkonnosti je vykoupeno men¹í spolehlivostí dat, které nemusí být v danou chvíli aktuální.
\item {\bf Vrstvy}\\
Systém podle REST by mìl být sestaven z více vrstev a ka¾dá vrstva komunikuje pouze se sousedními vrstvami. Napøíklad webový prohlí¾eè si vy¾ádá data od web serveru, ale ji¾ neví o databázi, kterou server vyu¾ívá k získání po¾adovaných dat.
\item {\bf Jednotné komunikaèní rozhraní}\\
Jednotlivé komponenty systému musí mít jednotné rozhraní. Co¾ mù¾e mít za následek men¹í výkon systému, proto¾e rozhraní nebude vytvoøeno podle vlastností aplikace. Pro vytvoøení jednotného rozhraní jsou vytvoøeny omezení, která musí daný systém splòovat. Mezi nì patøí identifikace zdrojù, manipulace se zdrojem skrze jeho reprezentaci, zprávy mezi komponentami systému musejí být sebe popisující,  hypermédia jsou prostøedkem ke stavu aplikace. 
\item {\bf Kód na vy¾ádání}\\
Nepovinnou funkcionalitou je tzv. kód na vy¾ádání. Tento pojem souvisí s roz¹íøeními, které jsou zasílána klientské aplikaci na vy¾ádání. Jedná se o dodateèný kód (Java applet, Javascript), který se spou¹tí na stranì klienta. Kód na vy¾ádání je nepovinnou charakteristikou, proto¾e vykonávání takovéhoto kódu mù¾e být na klientské stranì zakázáno.
\end{itemize}
Tyto vlastnosti nemusí být na první pohled úplnì srozumitelné, proto budou dále popsány na konkrétní technologii viz sekce REST webové slu¾by

\subsection*{REST webové slu¾by}
 Druhou koncepcí webových slu¾eb \cite{wsupandrunning}, se kterou se mù¾eme setkat a stává se velmi populární, jsou webové slu¾by respektující REST architektonický styl. Proto¾e REST stylu vyhovují vlastnosti HTTP protokolu a HTTP protokol je vyu¾íván ke konstrukci webových slu¾eb, byly vlastnosti REST pou¾ity pro konstrukci webových slu¾eb. Nyní bude popsáno propojení REST vlastností a omezení, která byla pøedstavena døíve v textu, s protokolem HTTP a následnì spojení s technologii webových slu¾eb. 
\\\\\\
HTTP protokol splòuje REST vlastnosti a omezení díky následujícím vlastnostem:
\begin{itemize}
\item {\bf Architektura klient/server}\\
Samotný protokol HTTP je konstruován stylem dotaz/odpovìï klienta a serveru. 
\item {\bf Bezstavovost}\\
Tato vlastnost u¾ musí být implementována specificky na dané architektuøe, která je postavena nad HTTP protokolem. Pokud je kontext ukládán na serveru, tak se nejedná o aplikaci zalo¾enou èistì na principech REST.  
\item {\bf Mezi-pamì»}\\
Mezi-pamì» mù¾e vyu¾ívat i HTTP protokol pro ukládání odpovìdí na klientské stranì.
\item {\bf Vrstvy}\\
Vícevrstvé rozdìlení je vyu¾ito v rámci HTTP protokolu. Kdy¾ si webový prohlí¾eè vy¾ádá od serveru data, není si vìdom napø. databáze, se kterou server dále komunikuje. 
\item {\bf Identifikace zdrojù}\\
Zdroje v HTTP mohou být identifikovány pomocí URI.
\item {\bf Manipulace se zdroji pomocí jejich reprezentace }\\
Data, která jsou odesílání pomocí HTTP mohou být pøená¹ená v jiné reprezentaci ne¾ jak jsou ulo¾ena, èili mohou být pøená¹eny jednotným zpùsobem (JSON, XML apod.).
\item {\bf Sebe popisující zprávy }\\
Tuto vlastnost HTTP protokol implicitnì nesplòuje, je tøeba tuto vlastnost doplnit ve vrstvì, která je implementována nad HTTP protokolem.
\item {\bf Hypermédia jako prostøedek stavu aplikace}\\
Toto omezení se vztahuje k vyu¾ití HTML dokumentù. Klient komunikuje se serverem pomocí hypermédii, které jsou dynamicky zprostøedkovány serverem. Klient nemusí nutnì být schopen interpretovat ka¾dý druh média, který mu je serverem nabídnut. Správnou interpretaci urèitých druhù médii je mo¾no dosáhnout kódem na vy¾ádání, který dodateènì umo¾ní správnou interpretaci.
\end{itemize}

\noindent Nyní jsme si ukázali, ¾e HTTP protokol je mo¾no pou¾ít pro aplikace zalo¾ených na REST principech. 

 Základní princip webových slu¾eb je zprostøedkování aplikaènì nezávislého komunikaèního rozhraní. Pro vytvoøení jednotného a aplikaènì nezávislého komunikaèního rozhraní je mo¾né pou¾ít HTTP protokol, a zprostøedkovat tak aplikace, které jsou vytvoøeny rùznými technologiemi. HTTP disponuje sadou pøíkazù, které je mo¾no vyu¾ít právì ke konstrukci webových slu¾eb respektující omezení REST. Základní pøíkazy, které se nejèastìji pou¾ívají jsou GET, PUT, POST, DELETE. Tato skupina operací se obecnì oznaèuje akronymem CRUD (Create, Read, Update, Delete ) a je mo¾né se s ní setkat v deklarativních zpùsobech programování.

\begin{itemize}
\item {\bf GET}\\
získání stavu zdroje
\item {\bf PUT}\\
vytvoøení nového zdroje
\item {\bf POST}\\
upravení zdroje
\item {\bf DELETE }\\
odstranìní zdroje
\end{itemize}
 Pro REST charakter webových slu¾eb jsou tyto operace naprosto dostaèující. Z akronymu REST - Representative State Transfer (pøenos reprezentativního stavu) - je patrné, ¾e se bude pøená¹et pouze stav. V pøípadì REST se pøená¹í stav po¾adovaného zdroje, pøesnìji jeho reprezentace. Aèkoliv se to na první pohled mù¾e zdát velmi limitující, ve skuteènosti mù¾e v pozadí tìchto pøíkazù pracovat velmi komplexní logika. 	 


\section{Testování software}
Testování je souèástí ¾ivotního cyklu software \cite{art_of_testing} \cite{testing_found}. Testování je obecnì neodmyslitelnou souèástí jakéhokoliv produktu, nejenom z oblasti IT. Pøeci jen, pokud chceme zaruèit urèité vlastnosti produktu, je tøeba tyto vlastnosti vyzkou¹et - otestovat. Jeliko¾ software vytváøejí lidé a ti nejsou neomylní, je tøeba provìøit mo¾né pochybení pøi vývoji software.

V ideálním pøípadì bychom pøi testování vyzkou¹eli v¹echny mo¾né zpùsoby pou¾ití, vstupy, prostøedí, abychom dùkladnì otestovali vytvoøený program. V reálném svìtì tento zpùsob není mo¾ný, proto¾e vyzkou¹et v¹echny mo¾né vstupy i jednoduchého programu je prakticky neøe¹itelný problém. K tomuto tvrzení staèí poukázat program, který seète dvì èísla z mno¾iny reálných èísel. Ne v¾dy je kompletní testování neøe¹itelný problém, minimálnì je v¹ak kompletní testování velmi nepraktické a hlavnì neekonomické.

Proto je tøeba si uvìdomit, ¾e nemù¾eme testovat v¹echny mo¾né vstupy. Aèkoliv nemù¾eme zaruèit absolutní bezchybovost software, mù¾eme se pokusit sní¾it poèet  chyb v software na minimum. Hlavním cílem testování je tedy odhalit co nejvìt¹í poèet chyb. Co¾ je paradox testování, proto¾e úspì¹né testování znamená odhalení chyby. Aby bylo testování úspì¹né a odhalilo co nejvíce chyb, je nutné k nìmu pøistupovat komplexním zpùsobem a poèínat si obdobnì jako pøi vývoji samotného software.  Podívejme se tedy na základní techniky testování software. 

\subsection*{Základní techniky testování software}
K popsání v¹ech dùle¾itých technik testování software by bylo potøeba celá kniha, zde budou popsány pouze ty základní metody nebo ty metody, které souvisejí s touto prací.

\subsubsection*{Statické a Dynamické testování}
Pokud pøi testování není tøeba spustit samotný program, jedná se o statické testování. To mù¾e být napøíklad procházení zdrojových kódù nebo dokumentace. Dùle¾ité je odhalení chyb ji¾ ve specifikaci po¾adavkù, proto¾e vytvoøení programu podle chybné specifikace patøí mezi ty opravdu nákladné chyby.

Dynamické testování vy¾aduje spu¹tìní urèité verze programu. Testování probíhá vkládáním mno¾iny vstupù a hodnocení dosa¾ených výstupù. Celá tato práce je zamìøena právì na dynamické testování, kam lze zaøadit i ní¾e popsané techniky.


\subsubsection*{Black box a White box testování}
Black box (èerná krabièka) je technika testování, pøi které  neznáme vnitøní strukturu programu. Black box testování se navrhuje hlavnì podle specifikace a je tøeba vhodnì navrhnout vstupní data tak, abychom dosáhli vyvá¾enosti mezi efektivitou a úplností testování. Pou¾ívají se dal¹í podpùrné techniky jako rozdìlení dat podle intervalù, rozdìlení dat podle ekvivalenèních tøíd apod.

White box (bílá krabièka) nebo také transparent box (prùhledná krabièka) je naproti Black box testování zamìøena na vnitøní strukturu programu. Zamìøuje se hlavnì na provedení ka¾dého pøíkazu, který je v programu napsán. V tomto smìru je lehce podobné black box testování, proto¾e otestování ka¾dého pøíkazu v tìle programu mù¾e být prakticky nemo¾né, minimálnì neefektivní. Dal¹ím aspektem testování struktury programu je také skuteènost, ¾e aèkoliv otestujeme ka¾dý mo¾ný pøíkaz v programu, pøesto v nìm mù¾e být chyba. Pøíkladem mù¾e být nedodr¾ení specifikace nebo chybná specifikace. 

\subsubsection*{Regresní testování}
Regresní testování  se obvykle provádí po implementaci nové funkcionality. Má za úkol provést testy star¹ích èástí programu, které ji¾ byly testovány. Tento druh testování je dùle¾itý, proto¾e zavedením nové funkcionality je mo¾né zanést chyby i do star¹ích èástí programu.


\subsubsection*{Výkonnostní testování}
Výkonnostní testování se vìnuje výkonu programu. Testovat výkon aplikace lze více zpùsoby. Program mù¾eme podrobit zátì¾ovému testování (stress testing), kdy jsou softwaru ztí¾eny podmínky pro fungování (odebrání pamìti, èas procesoru apod.) nebo je vystaven krátkodobému pøetí¾ení mno¾stvím vstupních dat. 

Pak je mo¾né testovat dlouhodobou zátì¾, kdy je program pøetí¾en mno¾stvím vstupních dat po del¹í dobu. Je¹tì je mo¾né opakovat jednu a tu samou operaci neustále do kola, co¾ má za cíl testovat zacházení s pamìtí.

\subsubsection*{Bezpeènostní testování}
Dùle¾itou souèástí testování je i test bezpeènostních opatøení. Pøi bezpeènostních testech se testuje zaji¹tìní základních po¾adavkù na bezpeènost, co¾ jsou {\it dostupnost}, {\it dùvìryhodnost}, {\it integrita}.  Pro bezpeènou aplikaci je nutné zabezpeèit v¹echny tyto tøi vlastnosti souèasnì, jinak nelze pova¾ovat aplikaci za bezpeènou. 

Proto¾e bez dostupnosti u¾ivatel nebude mít pøístup k datùm, aèkoliv jsou dùvìryhodná a bez po¹kození. Bez integrity jsou data dostupná a nebyly zobrazeny jiným u¾ivatelùm, ne¾ pro které byly urèeny, ale mohou být po¹kozená. Nakonec pokud data budou nezmìnìná i dostupná, mohou být vystavena nepatøièným u¾ivatelùm. 



\subsection*{Základní úrovnì testování software}
Vý¹e zmínìné techniky testování se mohou provádìt v rùzných úrovních vývoje softwaru. Podle úrovnì vývoje jsou pojmenovány i dal¹í techniky testování 

\begin{itemize}
\item{\bf Testování modulù} \\
Také známé jako Unit testing neboli testování jednotek. Zde se testují vìt¹í celky kódu programu. Pøi objektovì orientovaném programování se èasto jedná o testování jednotlivých tøíd. Obecnì se v¹ak testují vhodnì oddìlené úseky kódu, které jsou testovatelné oddìlenì. Pøi testování modulù je èasto nutné simulovat interakci s ostatními moduly.

\item{\bf  Integraèní testování}\\
Pøi integraèním testování se provádìjí testy spojení jednotlivých modulù. Testuje se rozhraní a interakce mezi jednotlivými moduly. Obecnì je pøedpokládáno, ¾e èím má integrace vìt¹í rozsah, tím je obtí¾nìj¹í odhalit rozhraní, ve kterém vznikla chyba. Z tohoto dùvodu vzniklo nìkolik pøístupù k integraènímu testování. 

První pøístup spoèívá v kompletní integraci v¹ech modulù, co¾ je jeden pól extrému. Pøi tomto pøístupu se nejdøíve sestaví v¹echny moduly a po té je zahájeno integraèní testování. Na první pohled se mù¾e takovýto pøístup jevit velmi výhodnì, pokud naivnì pøedpokládáme, ¾e se bìhem testování neobjeví ¾ádná chyba. Tento pøístup má hlavní nevýhodu právì ve vý¹e zmínìném pøedpokladu. Pokud je nalezena chyba je obtí¾né a èasovì nároènì ji odstranit. 

Protipólem je testovat spojení ka¾dého modulu zvlá¹». Tento pøístup je výhodný pro nacházení a odstraòování vzniklých chyb, ale zároveò je velmi èasovì nároèný, tedy neefektivní. Proto se pou¾ívají techniky, které jsou nìkde mezi tìmito dvìma extrémy.

\item{\bf Systémové testování}\\
Systémové testování se zamìøuje na program nebo produkt jako celek. Mù¾e obsahovat testy zalo¾ené na specifikaci, testování pøípadu u¾ití programu apod. Systémové testování je poslední úroveò vývojového testování, kdy se ovìøuje zda program odpovídá specifikaci. Pøi systémovém testování by se mìly testovat funkèní po¾adavky i ty, které pøímo s funkèností nesouvisejí. Mezi nefunkcionální testování patøí napøíklad výkonnostní testy, testy spolehlivosti, bezpeènostní testy apod. 

\item{\bf Akceptaèní testování}\\
Akceptaèní testování je zále¾itostí u¾ivatele, zákazníka nebo je provádìno prostøedí témìø identickém produkènímu, ne-li pøímo v produkèním prostøedí\footnote{Produkèní prostøední nebo produkce oznaèuje prostøedí, ve kterém bude program, produkt nasazen a pou¾íván}. Testuje je se hlavnì splnìní specifikovaných po¾adavkù na software a jestli dodaný software je schopen pracovat v daném prostøedí a je vhodný pro daný úèel. 

S akceptaèním testováním jsou spojené i pojmy Alfa a Beta testování. Alfa testování se provádí ve vývojovém prostøedí programátory a patøí do nìj vý¹e zmínìné úrovnì a techniky. Beta testování se provádí pøed oficiálním vydání softwaru, kdy si daný software nainstalují u¾ivatelé v reálném prostøedí a provádìjí testy. Beta testování se provádí v pøípadì, ¾e je software urèen pro ¹irokou ¹kálu u¾ivatelù.   
\end{itemize}

\section{Platforma jazyka Java }
\label{java}
\subsubsection*{Java Enterprise edition}
Platforma Java 	poskytuje více druhù pou¾ití jazyka Java. Tato práce se zamìøuje na pou¾ití podniková edice Java platformy (Java EE, Java Enterprise edition)\cite{Java}. Existuje více èástí platformy Java, které jsou urèené pro rùzné pou¾ití. Java EE se pou¾ívá pro vytváøení rozsáhlých podnikových aplikací a informaèních systémù. Základem Java EE je standardní edice jazyka Java (Java SE, Java Standard Edition), která se postupným vývojem roz¹íøila a musela být rozdìlena na více edici vèetnì Java EE.

Aplikaèní logika Java EE je rozdìlena do komponent podle funkce. Jednotlivé komponenty jsou umístìny v nìkolika aplikaèních vrstvách:
\begin{itemize}
\item {\bf Klientská vrstva} - umístìna na stranì klienta\\
Tato vrstva typicky obsahuje u¾ivatelské rozhraní pro ovládání cele aplikace.
\item {\bf Webová vrstva} - umístìna na stranì Java EE serveru\\
Na této vrstvì jsou umístìny komponenty vytváøející obsah, který je následnì odeslán klientovi.
\item {\bf Business vrstva} - umístìna na stranì Java EE serveru\\
Zde je implementována aplikaèní logika, která pøijímá vstupy od klienta, zpracovává je, pøípadnì je ulo¾í do databáze.
\item {\bf Vrstva Podnikový informaèní systém (EIS)}\\
Komponentami této vrstvy jsou databáze a podobné aplikace pro ukládání dat.
\end{itemize}

\begin{figure}[h]
\begin{center}
 \includegraphics[scale=0.5]{pic/JAVAEESTACK.png}
\caption{Jednotlivé vrstvy Java EE architektury. \cite{Java} }
\label{fig:JAVAEE}
\end{center}
\end{figure}

\noindent Takto navr¾ené vícevrstvé aplikace je obtí¾né vytváøet, proto jsou komponenty vytváøeny tak, aby byly znovupou¾itelné. Pak je mnohem snadnìj¹í vytváøet slo¾ité aplikace. Ka¾dá komponenta musí být umístìna do kontejneru. Kontejner je rozhraní mezi komponentou a funkcemi ni¾¹í úrovnì, které jsou implementaènì závislé. Obecným kontejnerem je aplikaèní server, který zprostøedkovává slu¾by ostatním kontejnerùm a komponentám. Na aplikaèní server je mo¾né nasadit tzv. Enterprise JavaBeans (EJB)\footnote{EJB je  kontejner, vhodný pro implementaci aplikaèní logiky} a Web kontejner, do kterých lze umis»ovat patøièné komponenty. Dále existují klientský a applet kontejner, které jsou vhodné pro klientskou èást aplikace.

Pro vytváøení vícevrstvých aplikací Java EE obsahuje velké mno¾ství technologii a jejich specifikací, které je mo¾no rozdìlit do nìkolika kategorii:

\begin{itemize}
 \item {\bf Webové slu¾by}\\
	Zahrnuje specifikace technologii pro implementaci SOA pomocí webových slu¾eb. Napøíklad obsahuje specifikaci pro tvorbu webových slu¾eb zalo¾ených na XML (JAX-WS). JAX-WS je mo¾né vyu¾ít k tvorbì klientských aplikací a webových slu¾eb zalo¾ených na XML .  Mezi klienty a slu¾bami lze vytvoøit komunikaci zalo¾enou na zprávách nebo vzdálené volání procedur (RPC, Remote Procedure Call).
 \item {\bf Webové aplikace}\\
	Zde jsou uvedeny technologie pro tvorbu webových aplikací a podporu pro implementaci modelu model-view-controller (MVC). Významnou specifikací z této kategorie je JavaServer Pages (JSP), která se pou¾ívá k tvorbì dynamických webových stránek. Pou¾ívá se spoleènì se specifikací Java Servlet. Servlet je komponenta bì¾ící v rámci webového serveru. Pøijímá dotazy od klientù a generuje odpovìdi ve formì HTML dokumentu. JSP slou¾í k oddìlení u¾ivatelského rozhraní od aplikaèní logiky. Pomocí JSP se vytváøí HTML dokument s vnoøenými úseky Java kódu. 
 \item {\bf Podnikové aplikace}\\
	 V této kategorii jsou uvedeny technologie pro implementaci business logiky a rùzných podpùrných technologii. Pro vytváøení podnikových aplikací je vhodná specifikace Enterprise JavaBeans (EJB). Pomocí EJB jsou vytváøeny komponenty, které oddìlují aplikaèní logiku od prezentaèní vrstvy. Hlavní vlastnosti EJB komponent by mìla být znovupou¾itelnost. EJB komponenty je mo¾no vyu¾ít k zaji¹tìní bezpeènosti, transakèního zpracování nebo také k testování. Pro komunikaci mezi jednotlivými komponentami je vhodná specifikace Java Messaging Service (JMS). 
 \item {\bf Správa a zabezpeèení }\\
	 Obsahuje technologie pro monitorování a zabezpeèení vytvoøených aplikací. Pro tvorbu monitorovacích aplikací se pou¾ívá specifikace Java Management Extensions (JMX). JMX umo¾òuje vytváøet aplikace s webovým rozhraním, které slou¾í k monitorování a správì rùzných zaøízení, aplikací nebo sítí se slu¾bami. Aplikace v rámci JMX jsou vytváøeny pomocí Managed Bean (MBean) komponent, které zaji¹»ují spojení se sledovaným objektem.
\end{itemize}

	


\chapter{Testování webových slu¾eb}
 Tato èást se bude vìnovat aspektùm testování webových slu¾eb  se zamìøením na testování robustnosti a odolnosti \cite{webservices}. Na testování webových slu¾eb se mù¾eme dívat jako na testování jakéhokoliv jiného software, av¹ak musíme vzít v úvahu nìkolik zásadních skuteèností. Webové slu¾by a» u¾ s pou¾itím SOAP protokolu nebo REST principù jedná se o vzdálené aplikace, které se mohou skládat z nìkolika vrstev. Dále pak webové slu¾by mohou být kompletnì bez grafického u¾ivatelského rozhraní, co¾ znesnadòuje manuální testování, na druhou stranu je zde vìt¹í prostor pro automatizaci testování.


\section{Rùzné pohledy na webové slu¾by}
Pøi testování webových slu¾eb se mù¾eme setkat s rùznými aspekty, které vyplývají z jejich pou¾ití. Webové slu¾by jsou velice èasto implementovány s typem komunikace dotaz/odpovìï nebo alespoò odvozeným zpùsobem. Tedy lze rozdìlit úèastníky v komunikaci na klienty a server, kdy klient ode¹le dotaz a server (slu¾ba) ode¹le odpovìï. Zde je nutné si uvìdomit, ¾e pokud testujeme klient/server aplikace, je nutné otestovat tyto èásti oddìlenì. Musíme si být jistí, ¾e server dává správnì odpovìdi a klient odesílá správnì dotazy. Proto¾e pokud jedna èást (napø. klient) odesílá chybná data, druhá èást pak nemusí odesílat data adekvátním zpùsobem.

\subsection*{Server}
Pro webové slu¾by je toto základní pohled, proto¾e slu¾ba je umístìna na vzdáleném stroji a plní tak roli serveru v architektuøe klient/server. Z tohoto pohledu se testují reakce webové slu¾by na zaslané dotazy a analyzují se pøijaté odpovìdi. Pro tento typ testování je nutno vytvoøit klientskou èást aplikace. Klientskou èást aplikace pro testování je mo¾no vytvoøit automatizovanì. Existují nástroje pro generování klientských rozhraní jak pro SOAP webové slu¾by, tak i pro webové slu¾by zalo¾ené na REST principech. Pøíkladem takové technologie je JBoss Wise.

\subsection*{Klient}
Pokud vyu¾íváme webových slu¾eb vìt¹inou se nespokojíme s vygenerovanou klientskou èástí aplikace a je tøeba ji roz¹íøit. Proto je tøeba klientskou èást aplikace také podrobit testování. Nejdøíve otestujeme klientskou èást s tzv. fale¹ným serverem (stub server). Stub server má pouze shodné rozhraní se skuteènì pou¾itým. Co¾ umo¾òuje velmi rychle vytvoøit testovací server, se kterým je mo¾no vyhodnotit vlastnosti odesílaných dotazù.

\section{Rùzné umístìní webových slu¾eb}
Dále pak je nutné uva¾ovat umístìní webových slu¾eb. Webové slu¾by mohou být dostupné z intranetu, kdy jsou slu¾by umístìny v uvnitø podnikové sítì a pøístup k nim mají pouze zamìstnanci nebo u¾ivatelé s pøístupem do dané uzavøené sítì. Pak existují webové  slu¾by dostupné z internetu, které jsou veøejnì dostupné.

\subsection*{Intranet}
Pokud je slu¾ba dostupná pouze z vnitøní sítì je mo¾né pøibli¾nì odhadnou kolik u¾ivatelù bude danou webovou slu¾bu vyu¾ívat, proto¾e pøístup do vnitøní sítì obvykle má omezený poèet u¾ivatelù. Pokud u¾ivatelé  pøistupují ke slu¾bì ve vnitøní síti z vnìj¹í sítì, mù¾e simulaci tohoto pøípadu u¾ití komplikovat pou¾itá bezpeènostní opatøení ( firewall, autentizace, VPN, apod.).

\subsection*{Internet}
U veøejnì dostupných webových slu¾eb je obtí¾nìj¹í odhadnout kolik u¾ivatelù bude tuto slu¾bu vyu¾ívat. Na druhou stranu, zde nemusejí být tak vysoké nároky na zabezpeèení jako na webové slu¾by dostupné z intranetu.

\section{Izolace webových slu¾eb}
Pøi testování webových slu¾eb je v nìkterých pøípadech potøeba cílovou webovou slu¾bu izolovat. Izolace webové slu¾by se vyu¾ívá v pøípadech, kdy je potøeba simulovat propojení s dal¹ími slu¾bami nebo systémy. Tyto slu¾by jsou simulovány tzv. {\it Mock} slu¾bami. Mock slu¾ba disponuje shodným rozhraním jako její vzorová slu¾ba, av¹ak její funkcionalita není implementována a je omezena na konstantní odpovìï. Toto øe¹ení je výhodné v testovacích prostøedích z více dùvodù. Vzorové slu¾by mohou být placené, jejich implementace nemusí být veøejná, mají del¹í èas odezvy ne¾ Mock slu¾by, Mock slu¾by dovolují testovat jednotlivé celky systému oddìlenì apod.

Mock slu¾eb se vyu¾ívá také pøi zátì¾ovém testování. Mock slu¾by zatì¾ují cílový systém minimálnì, a tak je mo¾né izolovat cílovou slu¾bu a zamìøit se pouze na testování této slu¾by.


\section{Po¾adavky na webové slu¾by}
Webové slu¾by vy¾adují pro správné fungovaní specifické po¾adavky. Tìchto po¾adavkù je nìkolik skupin a obecnì se dají shrnout do jednoho pojmu - kvalita slu¾eb (QoS, Quality of Service). Pojem kvalita slu¾eb souvisí s více vrstvami TCP/IP modelu, proto¾e informace proudí skrze internet. V této práci se v¹ak hlavnì budeme zabývat kvalitou slu¾eb z pohledu aplikaèní vrstvy\footnote{Pojem QoS je také spojován s protokoly ni¾¹ích vrstev, kde zaji¹»uje speciální zacházení s urèitými typy informací (video, hlas apod.)}. 

Základními pojmy kvality slu¾eb jsou spolehlivost, výkon, robustnost, bezpeènost a ostatní jsou spí¹e odvozeny od tìchto základních po¾adavkù. Pokud je tøeba formální a pøesné rozli¹ení jednotlivých pojmù je vytvoøena tzv. dohoda o úrovni poskytování slu¾by (SLA, Service Level Agreement).

\begin{itemize}
\item {\bf Spolehlivost}\\
Spolehlivost u webových slu¾eb souvisí s plnìním definovaných po¾adavkù na slu¾bu. Pokud slu¾ba splòuje definované po¾adavky jako èas odezvy, dostupnost, schopnost zpracovat urèitý poèet transakcí za daný èasový okam¾ik apod., je oznaèena za spolehlivou. Spolehlivost tak mù¾e být a èasto také je provázána s ostatními po¾adavky.
\item {\bf Výkon }\\
Výkon webové slu¾by vyjadøuje jak rychle doká¾e webová slu¾ba plnit po¾adované operace. Výkon lze dále rozdìlit na propustnost, doba odezvy a èas provedení. S výkoností souvisí i ¹kálovatelnost, proto¾e webová slu¾ba musí být ¹kálovatelná. Webové slu¾by by mìly být pøipraveny na pøípadné roz¹íøení v pøípadì nedostateèného výkonu.
\item {\bf Robustnost}\\
Robustnost je schopnost slu¾by fungovat pøedvídatelným zpùsobem pøi nesprávných, chybných, neúplných vstupech.
\item {\bf Bezpeènost}\\
Jeliko¾ jsou webové slu¾by èasto exponovány velkému poètu u¾ivatelù, je nutné se zaruèit její bezpeènost. Mezi základní bezpeènostní vlastnosti patøí dostupnost, integrita a dùvìrnost.
\end{itemize}


\section{Zpùsoby testování webových slu¾eb}
Jeliko¾ webové slu¾by patøí mezi distribuované aplikace, je nutné nejdøíve testovat dostupnost dané slu¾by. Pokud slu¾ba není z nìjakého dùvodu dostupná, dal¹í druhy testování (rozhraní, zátì¾ové, bezpeènostní) ztrácejí na významu. Po té co zjistíme, ¾e slu¾ba je dostupná, je vhodné ovìøit její správné fungování funkcionálními testy. Pokud webová slu¾ba vykazuje správnou funkcionalitu, je vhodné otestovat dal¹í vlastnosti jako napøíklad bezpeènost nebo výkonost slu¾by.

\subsection*{Funkcionální testování}
Cílem funkcionálního testování v rámci webových slu¾eb je zji¹tìní, zda-li slu¾ba je dostupná a její funkcionalita odpovídá její specifikaci. V první øadì se testuje spojení, ve vìt¹inì pøípadù se jedná o HTTP po¾adavek. Pøijaté odpovìdi jsou pak podrobeny patøièné analýze.  

\subsection*{Testování odolnosti}
Testování odolnosti software døíve zmínìna nebyla, proto¾e bývá zahrnuta do obvyklého testování. V pøípadì webových slu¾eb v¹ak nabývá zvlá¹tního významu, proto¾e se jedná o distribuovanou technologii. Testování odolnosti se zabývá simulováním prostøedí, kde se vyskytuje vìt¹í èi men¹í mno¾ství chyb. Chyby jsou vkládány do dat, se kterými aplikace pracuje, do komunikace mezi jednotlivými èástmi aplikace apod. Do kategorie testování odolnosti spadá i technika injekce chyb, kdy se testuje reakce webové slu¾by na nevhodný nebo po¹kozený vstup.

Injekce chyb pøedstavuje techniku testování odolnosti aplikace. Pøi injekci chyb se zámìrnì vkládají chyby buï do zdrojového kódu pøed kompilací nebo za bìhu programu. Pøi vkládání chyb do zdrojového kódu programu pøed kompilací se jedná o tzv. {Compile-Time Injection}. Tuto techniku je mo¾no pou¾ít jak pro simulování softwarových chyb, tak i hardwarových. Technika zalo¾ená na vkládání chyb za bìhu programu se nazývá {Run-Time Injection}.Pro injekci chyb do webových slu¾eb lze vyu¾ít  techniku vkládání chyb za bìhu programu. Více informací obsahuje diplomová práce Martina ®ou¾elky, na kterou tato práce bude navazovat.


\subsection*{Zátì¾ové testování}
Webová slu¾ba je druh webové aplikace tedy k ní mù¾e pøistupovat velké mno¾ství u¾ivatelù. Proto je nutné vìdìt kolik u¾ivatelù je daná webová slu¾ba schopna obslou¾it za urèitý èasový okam¾ik. V tomto smìru existuje více zpùsobu jak pohlí¾et na výkonnost webové slu¾by. Je mo¾né mìøit poèet zpracovaných po¾adavkù za sekundu, poèet u¾ivatelù pøi zachování stejné latence. Zátì¾ové testy se v¹ak musí provádìt automaticky, proto¾e je obtí¾né testovat napø. obsluhu 1000 u¾ivatelù.


\subsection*{Bezpeènostní testování}
Bezpeènost je velmi dùle¾itou vlastností webových slu¾eb. Také je obtí¾né jí dosáhnout kvùli jejich vlastnostem.  Bezpeènostní rizika pøedstavují sebe-popisující zprávy, které øeknou o webové slu¾bì velmi mnoho informací. Dále pak zprávy mohou putovat nepøedvídatelnou cestou. 

U webových slu¾eb se provádí tzv. penetraèní testování, které má za cíl odhalit zranitelnosti webové slu¾by rùznými druhy útokù. Dal¹í zpùsob pasivnì odchytává komunikaci webových slu¾eb a analyzuje obsah zpráv. Tedy k bezpeènostnímu testování lze pøistupovat aktivním nebo pasivním zpùsobem.


\section{Ji¾ existující nástroje pro testování webových slu¾eb}
Cílem této práce je vytvoøit nástroj pro testování webových slu¾eb. Pøi vytváøení nejen programových nástrojù by se mìl tvùrce zabývat tím, zda-li u¾ nebyl podobný nástroj vytvoøen. Takovýto prùzkum je dùle¾itý, aby se nástroj nevytváøel zbyteènì znovu, kvùli inspiraci funkcionality nebo právì kvùli chybìjícím funkcionalitám v ji¾ existujících øe¹eních.	

V této èásti práce jsou vybrány nástroje související s funkèním a zátì¾ovým testováním. Jako poslední bude struènì popsán nástroj FIWS, který je výsledkem pøedcházející diplomové práce.
\subsection*{soapUI}
soapUI \cite{soapUI}je nástroj s otevøeným kódem  zamìøený na testování. Disponuje velkým mno¾stvím funkcí vèetnì mo¾nosti testování webových slu¾eb. Umo¾òuje testovat SOAP i REST webové slu¾by funkcionálními testy. Pokud je doinstalováno roz¹íøení loadUI, lze provádìt i zátì¾ové testy. Roz¹íøení LoadUI disponuje mo¾ností distribuovaného testování. U¾ivatelské rozhraní je intuitivní a snadné na ovládání. Projekt disponuje i zásuvným modulem pro prostøedí Eclipse i NetBeans, ale tento modul není pøíli¹ stabilní a pro pohodlnìj¹í vytváøení a provádìní testovacích scénáøù je lep¹í pou¾ít nativní u¾ivatelské rozhraní.

Projekt lze provázat s automatizaèním nástrojem Apache Ant. Po vytvoøení a vyladìní testovacích scénáøù pomocí nativního u¾ivatelského rozhraní lze tyto testovací scénáøe provádìt automaticky s pou¾itím nástroje Ant. Tento zpùsob integrace je velmi efektivním øe¹ením a tato práce bude tímto zpùsobem inspirována. Zároveò lze integrovat soapUI s JUnit, co¾ je implementace testování modulù v jazyce Java.

\subsection*{JMeter}
JMeter\textsuperscript{\texttrademark} \cite{jmeter}  je alternativou k soapUI, av¹ak nenabízí tak ¹iroký zábìr funkcionalit jako soapUI. JMeter je specializován na testování webových slu¾eb. Disponuje distribuovaným modelem pro testování webových slu¾eb a mo¾ností integrace s automatizaèními nástrojem Ant a testování modulù JUnit. U¾ivatelské rozhraní je obdobné jako u soapUI a je také intuitivní. Projekt JMeter nedisponuje zásuvným modulem do vývojových prostøedí. Dal¹í odli¹ností od soapUI je mo¾nost upravit si vzhled XML výstupù pomocí roz¹íøitelného jazyka pro styly (XSL, eXtensible Stylesheet Language).


\subsection*{The Grinder}
Tento nástroj je opìt velmi podobný pøedchozím. Jeho hlavní odli¹nost spoèívá v jeho ovládání. The Grinder \cite{grinder} je uzpùsoben k ovládání pomocí skriptù v jazycích Jython a Closure. The Grinder je vytvoøen v jazyce Java, tedy i jazyky Jython a Closure jsou pou¾ívány pro ovládání The Grinder v rámci Java virtuálního stroje. Tento zpùsob ovládání  nabízí ¹irokou ¹kálu mo¾ností, na druhou stranu vy¾aduje znalost jednoho z tìchto jazykù. The Grinder ve verzi 2 nabízí zásuvný modul pro testování s JUnit, av¹ak ve verzi 3 byl odstranìn. The Grinder disponuje zásuvným modulem pro vývojové prostøedí Eclipse, který umo¾òuje spou¹tìní a ladìní testovacích skriptù.

\subsection*{Pøedchozí diplomová práce - FIWS}
FIWS reprezentuje nástroj pro injekci poruch. Je specializován na vkládání poruch do komunikace webových slu¾eb pomocí proxy monitorovací jednotky. Tato jednotka zachytává pøíchozí a odchozí HTTP komunikaci, analyzuje ji, pøípadnì modifikuje procházející zprávu. Nástroj je mo¾no ovládat pomocí u¾ivatelského rozhraní. Kompletní popis obsahuje daná diplomová práce.


\chapter{Specifikace po¾adavkù}
V této èásti bude roz¹íøeno a upøesnìno oficiální zznázornìnadání.  Specifikace po¾adavkù je dùle¾itou souèástí vývoje softwaru, proto¾e v této fázi jsou jednoznaènì definovány po¾adavky na vytváøený produkt. Nejdøíve budou specifikovány základní funkce nástroje po té dal¹í dva body detailnìji specifikují po¾adavky ze zadání. Dále pak bude následovat roz¹íøení v podobì distribuované architektury. 


\section{Základní koncept}
Základní koncept obsahuje základní po¾adavky, bez kterých by nástroj byl nefunkèní. Jedná se tedy o jádro nástroje. 

\subsection*{Základní funkce nástroje}
Nástroj bude umo¾òovat vytvoøení testovacích dat. Testovací data se budou vytváøet automatizovanì z dokumentù WSDL, pomocí grafického u¾ivatelské rozhraní nebo je bude mo¾no importovat ji¾ pøipravené. Testy bude mo¾no upravovat. Testy vygenerované pomocí WSDL dokumentu budou dále v textu nazvány jako kostra testu, proto¾e budou vytvoøeny testy pouze v základní podobì a èasto je bude tøeba upravit.

Dal¹í základní funkcí je spu¹tìní testù. Testy bude mo¾né spou¹tìt z pøíkazové øádky. Nástroj bude obsahovat grafické u¾ivatelské rozhraní, kde mohou být obsa¾eny dal¹í roz¹íøení. 

Výsledky jednotlivých testù budou ulo¾eny a budou dostupné i po ukonèení bìhu nástroje.


\subsection*{Testovací jednotka}
Nástroj bude obsahovat jádro pro spou¹tìní testù. Tato jednotka bude umo¾òovat spu¹tìní pøipravených testù. Jednotku bude mo¾no spou¹tìt jak z pøíkazové øádky, tak z grafického prostøedí. Tato jednotka bude základem pro roz¹iøující vlastnosti popsané dále ve specifikaci.

\subsection*{Testování SOAP webových slu¾eb}
Nástroj bude umo¾òovat testování SOAP webových slu¾eb. To znamená, ¾e jednotka bude podporovat manipulaci se SOAP zprávami a vytváøení HTTP po¾adavkù. Manipulaci se rozumí odeslání SOAP zprávy a pøijetí její odpovìdi, pokud to charakter testováni bude vy¾adovat.

\subsection*{Testování REST webových slu¾eb}
Nástroj bude umo¾òovat testování REST webových slu¾eb. To znamená, ¾e jednotka bude podporovat HTTP pøíkazy, které jsou popsány v sekci REST webové slu¾by. Bude také ukládat odpovìdi od slu¾by, pokud to charakter testování bude vy¾adovat.

\subsection*{U¾ivatelské rozhraní pro pøíkazovou øádku}
Nástroj bude mo¾no ovládat pomocí pøíkazové øádky. Z pøíkazové øádky bude mo¾né ovládat základní funkce nástroje tzn. generováni základních testù, konfigurace testù, spu¹tìní testù, ulo¾ení výsledkù testù. 

\subsection*{Grafické u¾ivatelské rozhraní}
Grafické u¾ivatelské rozhraní bude umo¾òovat pøehledné vytváøení testù dle po¾adavku na strukturu. Testy bude mo¾no vytváøet upravovat i ru¹it. Testy bude mo¾no aplikovat spu¹tìním jednotky pro spou¹tìní testù. Rozhraní bude umo¾òovat pøehledné zobrazení vybraných výsledkù testù. V grafickém u¾ivatelském rozhraní dále bude mo¾né ovládat vzdálené procesy, které budou umo¾òovat pøedání vytvoøených testù a spu¹tìní testovací jednotky.

\subsection*{Struktura testovacích dat}
Jednotlivé testy budou moci být vytváøeny ve vìt¹ích celcích, které spolu souvisejí. Napøíklad v¹echny testy pro jednu slu¾bu budou ulo¾eny ve spoleèné slo¾ce na disku.

\subsection*{Automatizace generování vzorù pro testování}
Pokud je slu¾ba popsána standardizovaným zpùsobem (WSDL, WADL apod.) bude mo¾no pro tuto slu¾bu vygenerovat základní sadu testù na základì tìchto dokumentù. 





\section{Navázání na pøedchozí práci}
Proto¾e tato práce navazuje na diplomovou práci vztahující se k injekci chyb v komunikaci webových slu¾eb, je tøeba pøedchozí výsledky roz¹íøit a zapracovat nové mo¾nosti. Dále pak jednotlivé souèásti budou spolupracovat tak, aby pomocí jednoho nástroje bylo mo¾né provádìt zátì¾ové testování i testování s injekcí chyb.

\subsection*{Umo¾nìní vytváøení testovacích pøípadù pro injekci chyb}
Nástroj bude umo¾òovat vytvoøení testovacích dat pro injekci chyb, které budou pou¾ity HTTP proxy jednotky, která je souèástí pøedchozí práce.

\subsection*{Spu¹tìní HTTP proxy procesu pro vkládání chyb do komunikace}
Spoleènì s mo¾ností spu¹tìní testovací jednotky musí být vytvoøena mo¾nost spu¹tìní HTTP proxy jednotky.

\subsection*{Podpora dal¹ích formátù dat pro injekci chyb }
HTTP proxy jednotka bude podporovat dal¹í formáty dat, do kterých bude mo¾no vkládat chyby. Dal¹ími formáty jsou my¹leny nìkteré reprezentace dat jako napøíklad JSON, YAML, HDF.

\subsection*{Podpora komprimovaných odpovìdí od webových slu¾eb}
HTTP proxy jednotka bude roz¹íøena o podporu analýzy komprimovaných odpovìdí od webových slu¾eb. Je tedy nutné implementovat podporu pro ètení dat komprimovaných typem GZIP. 

\section{Integrace s nástroji pro testování spolehlivosti}
Tento nástroj bude nabízet pouze nìkteré mo¾nosti testování webových slu¾eb, proto je velmi vhodné umo¾nit u¾ivateli pou¾ití tohoto nástroje spoleènì s dal¹ími nástroji podobného charakteru a docílit tak komplexních mo¾ností testování.

\subsection*{Automatizace provádìní testù}
Spou¹tìní testovací jednotky bude mo¾né provádìt pomocí automatizaèních nástrojù jako napø Apache Ant, aby bylo mo¾né vytváøet skripty, které by umo¾òovaly integraci více nástrojù do jediného skriptu.



\section{Distribuované testování}
Tato sekce specifikace bude zamìøena  na popis po¾adavkù pro distribuované provádìní testù. Toto roz¹íøení není souèástí zadání, ale je velmi vhodné vyu¾ití distribuované architektury pro zátì¾ové testování.

\subsection*{Správa procesù na vzdálených strojích}
Proces testovací jednotky musí nejdøíve bì¾et na vzdáleném stroji, pak bude mo¾né otestovat konektivitu s touto vzdálenou jednotkou. Vzdálené jednotky bude mo¾né testovat (konektivitu) a ukonèovat z grafického u¾ivatelského rozhraní i z rozhraní pøíkazové øádky. 

\subsection*{Spu¹tìní testù na vzdálených strojích }
Z obou u¾ivatelských prostøedí bude taky mo¾né zaslat po¾adované testy urèité jednotce èi více jednotkám a následnì jim odeslat pøíkaz ke spu¹tìní testování pøípadnì pøíkaz ke zastavení testování.

\subsection*{Odesílání výsledkù testù hlavnímu procesu}
Výsledky testù se budou zaznamenávat a bude na výbìr, zda-li je posílat automaticky centrálnímu ovládání nebo na pouze na vy¾ádání pøíkazem.	



\chapter{Návrh implementace}
Tato sekce popisuje dal¹í èást procesu vývoje softwaru. Návrh je velmi dùle¾itou souèástí vývoje, proto¾e kvalitní návrh ¹etøí prostøedky v dal¹ích fázích vývoje. V návrhu je uveden základní koncept nástroje, který se skládá z nìkolika souèástí. Nìkteré souèásti budou pøevzaty z pøedchozí diplomové práce a upraveny tak, aby splòovaly po¾adavky ze zadání.

Návrh vychází z volnì dostupných nástrojù soapUI a Grinder. Návrh také respektuje pøedchozí diplomovou práci a do nástroje bude zakomponována podpora pro injekci chyb. Vzhledem k tomu, ¾e jde o navazující práci, bude vytvoøenému nástroji ponechán jeho název FIWS (Fault Injektor for Web Services) a implementovaná roz¹íøení budou obsa¾eny ve verzi 2.0. 

K implementaci jsou vhodné platformy Java a .NET. Platforma Java nabízí multiplatformní øe¹ení a navíc je v ní vytvoøena pøedchozí práce. Je v¹ak vhodné vzít v úvahu i druhou mo¾nost, proto¾e vzhledem k webovým slu¾bám nabízejí obì platformy velmi podobné mo¾nosti implementace. 



\section{Základní koncept}
Základní koncept je znázornìn na obrázku \ref{fig:zaklad}. Základem FIWS 2.0  je testovací jednotka, která bude hrát roli univerzální klientské aplikace pro webové slu¾by, která je schopna odesílat a pøijímat HTTP po¾adavky webovým slu¾bám v po¾adovaném objemu a rychlosti s ohledem na mo¾nosti systému, na kterém je spu¹tìna. Data, která bude testovací jednotka odesílat budou pøedem pøipravena a budou testovací jednotce explicitnì pøedána. Bude tedy mo¾né pøedávat data pro odesílaní podle specifikovaného umístìní. Data pou¾itá pro odesílání musí  mít v¾dy stejný formát. To platí zejména pro data, která nebudou vytvoøena v nativním u¾ivatelském rozhraní.

U¾ivatelské rozhraní bude vytvoøeno v grafické podobì i v podobì ovládání z pøíkazové øádky. Testovací jednotka se bude moci ovládat pomocí dvou rozhraní, ale pouze jedním v daný okam¾ik, proto¾e je nevhodné ovlivòovat chod jedné instance testovací jednotky ze dvou rozhraní. Bude v¹ak mo¾no spustit více vláken testovacích jednotek souèasnì. Tento koncept umo¾ní spustit více instancí testovací jednotky na lokálním stroji a vyu¾ít tak efektivnì prostøedky systému.

Injekce chyb bude realizována oddìleným procesem, který bude hrát roli proxy serveru. Na obrázku znázornìna jako HTTP proxy jednotka. Bude monitorovat ve¹kerou komunikaci mezi testovací jednotkou a webovou slu¾bou. Spu¹tìná proxy jednotka obsahuje analyzátor a injektor chyb.  Více o injekci chyb je mo¾no se doèíst v pøedchozí práci.

Tento koncept lze také pou¾ít pro vytvoøení distribuované architektury, proto¾e dovolí oddìlit testovací jednotku od u¾ivatelských rozhraní. Oddìlení bude spoèívat v lehce rozdílném komunikaèním rozhraní. Testovací jednotka spoleènì s proxy jednotkou budou pod správou monitorovacího procesu, který bude mít Java RMI rozhraní a bude muset být spu¹tìn døíve ne¾ se s ním bude  vzdálenì manipulovat.





\begin{figure}[h]
\begin{center}
 \includegraphics[scale=0.8]{pic/zaklad2.png}
\caption{Základní koncept. }
\label{fig:zaklad}
\end{center}
	\end{figure}

\subsection*{Základní pou¾ití FIWS 2.0 u¾ivatelem}
Základní pou¾ití FIWS 2.0 znázoròují oèíslované ¹ipky, jejich¾ význam bude nyní popsán. Nejdøíve si u¾ivatel v grafickém u¾ivatelské rozhraní vytvoøí testovací data (1). Následnì spustí testovací jednotku (2), která si vyzvedne data ze specifikovaného úlo¾i¹tì (3). Testovací jednotka se pak spojí pøes proxy HTTP jednotku (4) s webovou slu¾bou (6). Mezi tím proxy jednotka za urèitých okolností vlo¾í chybu do komunikace(5). Testovací jednotka poté pøijme odpovìï, která také putuje pøes proxy jednotku a v¹echny výsledky ulo¾í do specifikovaného úlo¾i¹tì (7). U¾ivatel pak bude moci z grafického u¾ivatelského rozhraní vyhodnotit výsledky (8).   

\subsection*{Grafické u¾ivatelské rozhraní}
Grafické u¾ivatelské rozhraní bude slou¾it hlavnì k efektivní pøípravì testovacích dat. Musí obsáhnout mo¾nosti vytvoøit HTTP po¾adavek i s rùznými datovými reprezentacemi uvnitø datové èásti po¾adavku. REST webové slu¾by vy¾adují rùzné typy HTTP po¾adavkù vèetnì konfigurace datové èásti HTTP po¾adavku. SOAP zprávy vy¾adují konfiguraci zejména datové èásti, tedy vytvoøení XML dokumentu.

Testovací data se budou vytváøet v projektech. Ne¾ u¾ivatel bude moci zahájit jakoukoliv práci, musí vytvoøit nový projekt nebo otevøít ji¾ døíve vytvoøený. Struktura projektu bude obsahovat sada testù a jednotlivé testy, které mohou být vytvoøeny uvnitø sady testù nebo i zvlá¹». Struktura a nastavení projektu bude popsána v XML dokumentu. 

Na obrázku \ref{fig:editor} je návrh hlavního okna nástroje, kde je znázornìno rozlo¾ení ovládacích komponent. Na obrázku \ref{fig:modal} je znázornìno ¹ablona dialogového okna, která se bude pou¾ívat pro zadávání rùzných druhù vstupù a nastavení nástroje.

\begin{figure}[h]
\begin{center}
	\includegraphics[scale=0.5]{pic/editorWindow.png}
\caption{Návrh hlavní obrazovky nástroje. }
\label{fig:editor}
\end{center}
\end{figure}

\begin{figure}[h]
\begin{center}
 \includegraphics[scale=0.5]{pic/modalWindow.png}
\caption{©ablona pro modální okna nástroje. }
\label{fig:modal}
\end{center}
\end{figure}
  
\subsection*{U¾ivatelské rozhraní z pøíkazové øádky}
Testovací jednotka i HTTP proxy jednotka budou  vybaveny rozhraním pro pou¾ití tìchto jednotek z pøíkazové øádky. Budou pøebírat potøebné parametry pro lokalizaci testovacích dat. Z pøíkazové øádky bude mo¾né konfigurovat obì jednotky pomocí pøepínaèù nebo pomocí konfiguraèního souboru, kde budou po¾adované parametry a jejich hodnoty uvedeny formátem klíè='hodnota'.

\subsection*{Testovací data a vyhodnocení testù}
Testovací data se budou skládat z pøedem pøipravených HTTP po¾adavkù nebo z dat pro injekci chyb. Data pro injekci chyb se skládají z ulo¾ených podmínek a následné injekce vybrané chyby. Ka¾dý druh testovacích dat bude umístìn v adresáøi, který bude oznaèovat jejich druh. Takto budou moci jednotky vybírat pro nì urèená data. Toto je dùle¾ité pøi pøiøazení sady testù nìkteré z jednotek, proto¾e nebude nutné explicitnì uvádìt, která data pøíslu¹í které jednotce.  

\subsection*{Testovací jednotka}
Testovací jednotka je jádrem celé práce. Bude zodpovìdná za spojení se s webovou slu¾bou a odeslání a pøijetí HTTP po¾adavku. Testovací jednotka pøevezme nastavení (data, poèet spu¹tìných procesù, objem po¾adavkù apod.) od u¾ivatele a následnì provede po¾adované akce. Mezi základní operace testovací jednotky patøí navázání HTTP spojení s po¾adovanou webovou slu¾bou a odeslání patøièných dat. Spojení s webovou slu¾bou si vy¾ádá dal¹í funkcionality. Hlavní funkcí pøi spojení bude definování proxy serveru, aby mohla být pou¾ita HTTP proxy jednotka. Mezi dal¹í pak bude patøit mo¾nost autentizace a v neposlední øadì je velmi vhodná implementace bezpeènostních protokolù napø. mo¾nost pou¾ití HTTPS.


\section{Pou¾ití injekce chyb}	
HTTP proxy jednotka bude vytvoøena ze zdrojových kódù pøedchozí práce a bude pøizpùsobena ke samostatnému spu¹tìní. Funkce proxy jednotky tedy bude spoèívat v zachycení komunikace mezi testovací jednotkou a webovou slu¾bou. Tento princip lze vyu¾ít k zátì¾ovému testováni spojeném s injekcí chyb. 

Pøedchozí verze FIWS neumo¾òovala analýzu komprimovaných odpovìdí od webových slu¾eb. Pro implementaci této funkcionality je mo¾né pou¾ít knihovnu jazyka Java, která umo¾òuje manipulaci s komprimovanými daty. 

\section{Integrace s nástroji pro testování spolehlivosti}	
Integrace s ostatními nástroji bude mo¾né díky rozhraní pro pøíkazovou øádku. S pomocí ovládání z pøíkazové øádky bude mo¾né pou¾ít FIWS 2.0 spoleènì s automatizaèními nástroji jako je napøíklad Apache Ant, který umo¾òuje integrovat více nástrojù pro testování do jediného skriptu. 



	
\section{Distribuovaný model}
Distribuovaný model odesílání po¾adavkù je znázornìn na obrázku \ref{fig:dist}. Tento zpùsob odesílání umo¾ní reálnìj¹í simulaci vysokého poètu u¾ivatelù, proto¾e po¾adavky budou odesílány z rùzných fyzických strojù.

Pro implementaci správy jednotlivých procesù na vzdálených strojích je mo¾no pou¾ít technologii RMI, kterou nabízí platforma Java. V tomto pøípadì musí být obì strany vybaveny rozhraním RMI pro vzdálenou komunikaci. Na vzdáleném stroji musí bì¾et monitorovací jednotka, která bude zprostøedkovávat vzdálené pøíkazy pro testovací a proxy jednotky.

V grafickém u¾ivatelském prostøedí bude mo¾nost spojit se s ji¾ bì¾ícími instancemi monitorovacích jednotek a centralizovanì spravovat vzdálené stroje. V grafickém u¾ivatelském prostøedí se pro ka¾dé vzdálené spojení musí vytvoøit zvlá¹tní vlákno, proto¾e jiným zpùsobem nelze komunikovat s více vzdálenými stroji souèasnì.


\begin{figure}[h]
\begin{center}
 \includegraphics[scale=0.8]{pic/DIST_MODEL2.png}
\caption{Model distribuované architektury. }
\label{fig:dist}
\end{center}
\end{figure}

\subsection*{Centralizovaná správa a výmìna dat}
V¹echny vzdálené jednotky budou spravovány z jednoho centrálního bodu, kde bylo spu¹tìno grafické u¾ivatelské  rozhraní. Ovládání z pøíkazové øádky bude také mo¾né. Pøi ovládání vzdálených jednotek bude mo¾né provést test konektivity, distribuce dat a spu¹tìní vybraných jednotek. Pomocí skriptù (Bash, Perl, apod.) bude mo¾né distribuovat vybraná data vybraným jednotkám.  

Centralizovaná správa v¹ech jednotek je vhodná kvùli vytváøením a následné distribuci testovacích dat. V centrálním bodì se vytvoøí testovací data a roze¹lou se na vzdálené uzly, kde budou moci být vyu¾ity. 

Výsledky testù bude mo¾no zasílat automaticky v urèitých intervalech do centrálního bodu nebo na explicitní pøíkaz u¾ivatele.
%\newpage
\section{Návrh vrstev}
Návrh obsahuje distribuovanou architekturu a je vhodné rozvrhnout jednotlivé èásti do oddìlených vrstev. Rozdìlit aplikaci pøi návrhu do vrstev je výhodné, proto¾e usnadòuje dekomponovat slo¾itìj¹í problémy na podproblémy a sní¾it tak slo¾itost následné implementace. Obrázek \ref{fig:vrstvy} ukazuje rozlo¾ení jednotlivých vrstev. 

\begin{itemize}
\item {\bf Prezentaèní vrstva }\\
Prezentaèní vrstva obsahuje u¾ivatelská rozhraní (grafické, pøíkazovou øádku). Prezentaèní vrstva slou¾í k pøijmutí pøíkazù a dat od u¾ivatele. Dále slou¾í k zobrazení po¾adovaných výsledkù.  \\
\item {\bf Transportní vrstva }\\
Tato vrstva je zodpovìdná za distribuci dat v rámci aplikace. Bude pøijímat data od sousedních vrstev a plnit funkci prostøedníka, pøi pøedávání dat mezi prezentaèní  a datovou vrstvou.    \\
\item {\bf Datová vrstva }\\
Tato vrstva zprostøedkuje zápis dat na disk a jejich ètení. Manipulaci (ètení/zápis) s daty je mo¾no realizovat nìkolika zpùsoby. Díky oddìlení od zbytku aplikace je mo¾no implementaci ulo¾ení dat mìnit v dal¹ích verzích programu, ani¾ by do¹lo k významnìj¹ím zásahùm do implementace vy¹¹ích vrstev.  \\

\end{itemize}


\begin{figure}[h]
\begin{center}
 \includegraphics[scale=0.6]{pic/vrstvy.png}
\caption{Návrh vrstev aplikace. }
\label{fig:vrstvy}
\end{center}
\end{figure}

\section{Návrh úpravy proxy jednotky pro distribuovaný re¾im}
Na základì prostudování zdrojových kódù a otestování pùvodní implementace bylo zji¹tìno, ¾e bude nutné provést zmìny v pùvodním návrhu . Na obrázku \ref{fig:zmena} je znázornìno stávající zpracování zprávy proxy serverem a jeho plánovaná zmìna. Pro bli¾¹í pochopení, jak funguje stávající implementace a jak bude fungovat plánovaná implementace, jsou v obrázku umístìna èísla, jejich¾ význam je popsán ní¾e.

Proxy monitorovací jednotka be¾ící v nekoneèném cyklu pøijme zprávu (1) a vytvoøí nové vlákno pro jeho zpracování (2). Vlákno zpracuje zprávu a ode¹le jí kontroléru. Kontrolér pøedá zprávu injektoru(4,5) poruch, kde se provede analýza zprávy a její pøípadné naru¹ení. Kontrolér zastává funkci delegáta. Zobrazovací panel GUI je pøiøazen ke kontroléru. Kontrolér tedy odesílá(6) zprávu do panelu GUI, kde je zobrazena. Po zobrazení je zpráva vlo¾ena na výstup sí»ového rozhraní a pokraèuje urèeným smìrem. Tento stav je nevyhovující, proto¾e pøi tomto stavu je komplikované vytvoøit více monitorovacích jednotek na více strojích.

\begin{figure}[h]
\begin{center}
 \includegraphics[scale=0.6]{pic/zmenaproxy.png}
\caption{Schéma zpracování zprávy pøed a po úpravì proxy serveru. }
\label{fig:zmena}
\end{center}
\end{figure}
 
\noindent Zmìna spoèívá v pøesunutí úlohy delegáta na monitorovací jednotku a kontrolér bude pouze provádìt pøiøazení monitorovacích panelù GUI v monitorovacích jednotkách. Pak je mo¾né mít více nezávislých monitorovacích jednotek na rùzných strojích. Tyto jednotky pak budou odesílat získaná data do centrálního GUI, kde dojde k jejich zobrazení a zpracování. 

Stejného principu se vyu¾ije pøi detailním návrhu architektury.

\section{Analýza a návrh podpory dal¹ích datových formátu a chování proxy jednotky}
Pro vylep¹ení vlastností monitorování proxy jednotky jsou nutné dal¹í zásahy do implementace. Tato sekce se zamìøí na rozbor a návrh dal¹ích funkcí proxy jednotky. Zejména se bude jednat o interpretaci dal¹ích zpùsobù kódování a komprimace zachycovaných zpráv. Dále také bude uvedeno seznámení s dal¹ími reprezentacemi dat, které je mo¾né analyzovat pomocí injektoru poruch a pøípadnì naru¹it jejich integritu.

\subsection*{Podpora dal¹ích zpùsobù kódování}
V této èásti bude uvedena analýza chování proxy jednotky, pokud by mìla podporovat dal¹í zpùsoby kódování posílané komunikace. Jedná se o interpretaci polo¾ek hlavièky HTTP protokolu {\it Transfer-Encoding }, {\it Content-Encoding} klienty a proxy jednotkami. 

Polo¾ka {\it Content-Encoding} udává zakódování odesílaného obsahu na stranì koncových bodù. Komprimace uvedená v této polo¾ce probíhá {\bf pouze} na stranì klienta nebo serveru. 

Polo¾ka {\it Transfer-Encoding} udává zakódování obsahu zprávy bìhem transportu sítí. Komprimace mù¾e probìhnout kdekoliv na cestì zprávy mezi  koncovými body, vèetnì koncových bodù samotných. Toto zakódování probíhá a¾ po komprimaci udávané v polo¾ce {\it Content-Encoding}. Pokud jsou v hlavièce HTTP zprávy obì polo¾ky znamená to, ¾e zpráva byla zakódována nejdøíve zpùsobem uvedeným v polo¾ce {\it Content-Encoding} a následnì je¹tì zpùsobem uvedeným v polo¾ce {\it Transfer-Encoding}. Zpráva mù¾e mezi koncovými body být zpracována nìkolika proxy jednotkami, kdy poka¾dé mù¾e dojit ke zmìnì zakódování. Poka¾dé se v¹ak mìní pouze pozdìj¹í zpùsob zakódovaní, tedy {\it Transfer-Encoding}.

\noindent Dal¹í mo¾nosti pro vylep¹ení chování monitorovací jednotky
\begin{itemize} 
\item{ \bf Komprimace zpráv}\\
sdafasdfds\\
\item{ \bf Odesílání po èástech}\\
adsfasdf\\
\item{ \bf Monitorování bez injekce}\\
adsfasdf\\
\end{itemize}


\subsection*{Podpora dal¹ích datových formátù}

\noindent Dal¹í mo¾nosti pro podporu dal¹ích datových formátù injektoru poruchs
\begin{itemize} 
\item{ \bf JSON}\\
sdafasdfds\\
\item{ \bf YAML}\\
adsfasdf\\
\end{itemize}

\section{Detailní návrh architektury}
V této sekci budou spojeny jednotlivé postupy z pøede¹lých sekcí a bude pøedstaven detailní návrh architektury vytváøeného nástroje. V sekci jsou nastínìny jednotlivé souèásti nástroje a jak spolu mají komunikovat. Aby tato komunikace ¹la snadno implementovat byl pøedstaven návrh vrstev, do kterých budou jednotlivé souèásti rozmístìny, tak aby spolu komunikovaly pouze sousední vrstvy. Tento zpùsob návrh je výhodný kvùli rozdìlení slo¾itìj¹ích problému na podproblémy. Takováto dekompozice také usnadòuje pøípadné testování jednotlivých souèástí aplikace (Unit testing).

Jeliko¾ tato práce navazuje na ji¾ vytvoøenou implementaci, která nevyhovovala striktnímu rozdìlení do vrstev, bylo nutné vytvoøit návrh úprav, který je na obrázku . Po provedení úprav bude mo¾no vyu¾ít stávající implementaci a pøidat k ní dal¹í prvky, které vy¾aduje zadání práce.

\begin{figure}[h]
\begin{center}
 \includegraphics[scale=0.6]{pic/modelImpl.png}
\caption{Zobrazení implementace základního modelu. }
\label{fig:modelImpl}
\end{center}
\end{figure}

\noindent Na obrázku \ref{fig:modelImpl} je model rozdìlení jednotlivých souèástí aplikace do navr¾ených vrstev. Do prezentaèní vrstvy jsou jsou umístìna u¾ivatelská rozhraní. Do transportní vrstvy je umístìn kontrolér, proto¾e se stará o transport dat a pøíkazù mezi sousedními vrstvami. Jak je z obrázku patrné, u¾ivatelská rozhraní  jsou zodpovìdné za vytváøení dat, odesílání pøíkazù a zprostøedkování výstupù z aplikaèních jednotek. U¾ivatelská rozhraní komunikují pouze s kontrolérem a jsou odstínìna od odstaních operací.

Do transportní vrstvy jsou zahrnuty aplikaèní jednotky  a kontrolér. Aplikaèní jednotky slou¾í  ke vzdálené komunikaci s webovými slu¾bami a získávání dat. Aplikaèní jednotky v rámci aplikace komunikují pouze s kontrolérem a jsou tak odstínìny od u¾ivatelských rozhraní, ètení a ukládání dat.

Kontrolér je zodpovìdný za pøijímání dat od prezentaèní vrstvy a dle druhu komunikace deleguje data do aplikaèních jednotek nebo data odesílá datové vrstvì k ulo¾ení. Pokud vy¾aduje ètení dat, kontrolér deleguje zprávu do datové vrstvy a pøijme ji¾ data v po¾adovaném formátu. Hlavní úlohou kontroléru je delegace dat a pøíkazù mezi sousedními vrstvami.

Zprostøedkovatel dat má za  úkol èíst data ulo¾ená na disku ve formátu XML. Ve¹kerá data pøijatá od vy¹¹ích vrstev budou Java objekty, které se budou ukládat na disk v serializované podobì. Serializaci Java objektù do formátu XML a následné ulo¾ení na disk je mo¾no provést nìkterou z volnì dostupných knihoven. 

Souèástí této vrstvou jsou ulo¾ená data na disku. Tyto data budou mít hierarchickou strukturu kvùli efektivnìj¹í orientaci.



\chapter{Popis implementace}
Tato kapitola se vìnuje popisu implementace návrhu, který byl pøedstaven v pøede¹lé kapitole.  Vytvoøení jednotlivých èástí programu je postupnì popsáno v jednotlivých sekcích. U ka¾dé èásti jsou uvedeny pou¾ité technologie a postupy. Kapitola je rozdìlena na sekce tak, aby bylo zøejmé, ¾e implementace aplikace splòuje zadání. 

Nejdøíve je popsán výbìr implementaèního prostøedí a jazyka. Pak je pøedstavena implementace základních souèástí aplikace.  V dal¹ích sekcích pak jsou popsány implementace funkcí vytvoøeného nástroje. Pøi popisu jednotlivých funkcí jsou pak pou¾ity vytvoøené souèásti a je vysvìtleno jejich propojení a význam v dané funkcionalitì.



\section{Výbìr vývojového prostøedí a jazyka}
V dne¹ní dobì má vìt¹ina jazykù podporu pro vývoj aplikací pou¾ívající webové slu¾by. Mezi nimi v¹ak vyènívají platformy .NET a Java, které mají nej¹ir¹í podporu pro vývoj aplikací pro webové slu¾by.  Vzhledem k návaznosti této práce na práci, která je implementována na platformì Java, je vhodnìj¹í pou¾ití platformy Java. Platforma Java byla také zvolena kvùli zku¹enostem autora.

Pøi implementaci jsou pou¾ity souèásti Java SE a pro vytvoøení testovacích pøíkladù je pou¾ito souèástí Java EE. Jako prostøedí pro vývoj aplikace je mo¾no pou¾ít libovolný nástroj. Pro urychlení vývoje je v¹ak vhodné pou¾ít nìkteré integrované prostøedí (IDE). Velice známá jsou prostøedí NetBeans a Eclipse. Obì jsou multiplatformní a poskytují nástroje pro vývoj aplikací na platformì Java. Bylo zvoleno integrované prostøedí Eclipse. Eclipse prostøedí bylo zvoleno ze subjektivních dùvodù, proto¾e autor má toto prostøedí v oblibì.

\newpage
\section{Základní model aplikace}
V návrhu na obrázku \ref{fig:zaklad} byl pøedstaven základní model aplikace. Dále pak na obrázku \ref{fig:vrstvy} byl popsány jak by tento koncept mìl zapadat do vrstev. V této èásti je znázornìno jak jsou tyto dva pohledy na návrh aplikovány v implementaci. Obrázek \ref{fig:modelImpl} slou¾í jako vizualizace implementace. Jednotlivé èásti budou podrobnì popsány a dále v textu budou uvedeny dal¹í diagramy vysvìtlující tok dat a pøíkazù mezi jednotlivými souèástmi.

\subsection*{Reprezentace dat}
Pro organizaci dat bylo zavedeno hierarchické schéma, které je patrné na obrázku. Na nejvy¹¹ím úrovni je koøenový adresáø, který není v grafickém u¾ivatelském rozhraní (dále jen GUI) patrný. Koøenový adresáø se nachází v pracovním adresáøi aplikace a pokud není pøi startu aplikace pøítomen, je adresáø vytvoøen.

Dal¹í úroveò pøedstavují testovací sady. Jedna testovací sada je urèena pro jednu slu¾bu. Testovací sada obsahuje testovací pøípady k dané slu¾bì. Testovací sada dále obsahuje seznam testovacích pøípadù, které budou spu¹tìny testovací jednotkou. Tento seznam je reprezentován XML souborem {\it testlist.xml}.

Jednotlivé testovací pøípady pøedstavují dal¹í úroveò schématu. Ka¾dý testovací pøípad obsahuje slo¾ky pro vstupní a výstupní data pro aplikaèní jednotky. Tyto slo¾ky jsou zobrazeny v GUI jako {\it FaultInjection} a {\it Http}. Testovací pøípad dále obsahuje XML soubor {\it settings.xml}, kde jsou uvedeny nezbytná nastavení pro testovací pøípad. Obsah souboru s nastavením a slo¾ek pro aplikaèní jednotky je popsán ní¾e ve strukturovaném seznamu.
\begin{itemize}
\item {\bf Data pro nastavení testu }\\
Data pro nastavení testu obsahují informace, podle kterých se nastaví aplikaèní jednotky . V souboru {\it settings.xml}  je ulo¾ena instance tøídy {\it TestCaseSettingsData}, která nese informace pro spu¹tìní pro testovací a proxy jednotku. \\
\item {\bf Data pro testovací jednotku }\\
Data pro  testovací jednotku rozdìlena do slo¾ek pro vstupní ({\it input}) a výstupní data ({\it output}). Tyto slo¾ky nejsou v GUI zobrazeny. Ve slo¾ce pro vstupní data je XML soubor {\it input.xml}, kde jsou umístìna data pro testovací po¾adavek.  Do slo¾ky pro výstupní data se pak ukládají výsledky testù. Data ulo¾ená v souboru {\it input.xml} pøedstavuje serializovanou instanci tøídy {\it HttpMessageData}, která nese potøebné informace o HTTP po¾adavku. \\
\item {\bf Data pro injekci chyb }\\
Data pro injekci chyb jsou rozdìlena stejným zpùsobem jako data pro testovací jednotku. Data ulo¾ená v souboru  {\it input.xml} je pøedstavuje serializovanou instanci tøídy {\it FaultInjectionData}, která nese seznam podmínek a naru¹ení pro injektor poruch (viz.....)
\\
\end{itemize}

\subsection*{Zprostøedkovatel dat}
Zprostøedkovatel dat je reprezentován tøídou {\it DataProvider}, která byla ji¾ v pøedchozí implementaci. Tato tøída má na starosti  serializaci a deserializaci Java objektù do respektive z XML formátu. K tomuto druhu manipulace je pou¾ita knihovna Xstream. Ve¹kerá data jsou ulo¾ena na disku ve formì textových dat ve formátu XML. Pokud chce nástroj data pou¾ívat, data naète jako textový øetìzec a pomocí knihovny Xstream dojde k deserializaci. Pøesnì opaèným postupem se postupuje pøi zápisu instancí tøíd na disk.

 V pøedchozí implementaci byly metody z této tøídy volány pouze staticky. Pro úèely byla tato tøída pøepracována a metody jsou volány z instance dané tøídy.

\begin{figure}[h]
\begin{center}
 \includegraphics[scale=0.3]{pic/menu.jpg}
\caption{Náhled schématu dat zobrazeného v navigaèním panelu. }
\label{fig:vrstvy}
\end{center}
\end{figure}

\subsection*{Kontrolér}
Centrální souèást aplikace, která má za úkol delegovat pøíkazy z u¾ivatelských rozhraní do aplikaèních jednotek a zprostøedkovat pøenos dat mezi jednotlivými souèástmi. Dal¹í dùle¾itá úloha kontroléru je spu¹tìní vláken pro aplikaèní jednotky. 

V kontroléru existují tøídy ProxyUnitWorker a TestUnitWorker. Tyto tøídy roz¹iøují tøídu {\it SwingWorker}. Tøída {\it SwingWorker} umo¾òuje spustit vlákno na pozadí grafického u¾ivatelského rozhraní vytvoøeného pomocí sady Java Swing. Pøi spu¹tìní nástroje se nejdøíve vytvoøí instance lokálních aplikaèních jednotek. Dal¹í aplikaèní jednotky je mo¾no registrovat dynamicky pomocí grafického u¾ivatelského rozhraní. Jakmile z u¾ivatelského rozhraní pøijde pøíkaz ke spu¹tìní jednotky. Instance tøídy aplikaèní jednotky spustí nové vlákno. V novì vytvoøeném vláknì pak bì¾í testovací jednotka. Pokud jsou pøi testu pou¾ity obì aplikaèní jednotky, pak jsou vytvoøena dvì oddìlená vlákna.

Dále kontrolér má na starosti registraci zobrazovacích panelù do aplikaèních jednotek. Kontrolér má ulo¾eny v¹echny aplikaèní jednotky v abstraktním datovém typu {\it HashMap} s asociativním pøístupem. Ka¾dá jednotka je ulo¾ena pod poøadovým èíslem, se kterým byla vytvoøena. Po vytvoøení a ulo¾ení instance aplikaèní jednotky je vytvoøen v GUI zobrazovací panel se stejným poøadovým èíslem. Pomocí poøadového èísla je pak v kontroléru vyhledána patøièná aplikaèní jednotka a v aplikaèní jednotce je ulo¾en odkaz na zobrazovací panel. Po registraci zobrazovacího panel ji¾ kontrolér ztrácí svou delegaèní úlohu, proto¾e ve¹kerá komunikace probíhá mezi aplikaèní jednotkou a zobrazovacím panelem.
 
\subsection*{Testovací jednotka}
Testovací jednotka je jádrem této práce. Jejím hlavním úkolem je získat odpovìï od webové slu¾by. Základem jsou data pro testování. Data jsou ji¾ ve formì instance tøíd, která obsahují potøebné informace. Testovací jednotce jsou pøedány instance tøíd pro nastavení testu a HTTP po¾adavku. Z dat nastavení testu je pou¾ita informace o poètu vláken, který se má pou¾ít pro jeden testovací pøípad. Testovací jednotka podle pøidìleného poètu vláken dopøedu vytvoøí instance po¾adovaných vláken pomocí tøídy   {\it Executors}. Tøída  {\it Executors} doká¾e dopøedu vytvoøit fixní poèet vláken a spustit je a¾ jsou potøeba. Dopøedu vytvoøená vlákna ¹etøí výpoèetní prostøedky, proto¾e pøi jejich spu¹tìní odpadá re¾ie na jejich vytvoøení. Jednotlivá vlákna implementují rozhraní  {\it Callable}, tak¾e pøed ukonèením vlákna je vrácena hodnota. Pøi spu¹tìní je vlákna je odkaz na toto vlákno pøedán do instance tøídy {\it Future}. Instance  tøídy {\it Future} zaji¹»uje asynchronní zpracování výsledku vrácené návratové hodnoty 
vlákna.

Vlákna jsou spou¹tìny v poèítaném cyklu a jsou pøidìlena do pole obsahující instance tøíd {\it Future}. Po spu¹tìní následuje dal¹í cyklus, který blokujícím zpùsobem èeká na dokonèení jednotlivých vláken. Pøi ka¾dém pøijetí výsledku od vlákna je tento výsledek testovací jednotkou odeslán do zobrazujícího panelu, kde je výsledek okam¾itì zobrazen. Po skonèení blokujícího cyklu jsou v¹echna vlákna ukonèena øádným zpùsobem pomocí instance tøídy  {\it Executors}.


\begin{figure}[h]
\begin{center}
 \includegraphics[scale=0.3]{pic/testunit.jpg}
\caption{Náhled testovací jednotky. }
\label{fig:vrstvy}
\end{center}
\end{figure}

\subsection*{Proxy jednotka}
V této èásti je uveden struèný popis èinnosti proxy monitorovací jednotky. Pro detailní popis je mo¾no vyu¾ít pøedchozí práci.

Základní funkce proxy  jednotky je poslouchat na zadaném portu, na který pøijde HTTP po¾adavek pro cílovou webovou slu¾bu. Jakmile pøijde po¾adavek od klienta webové slu¾by proxy jednotka vytvoøí dvì vlákna pro obsluhu pøíchozího spojení a pro obsluhu odpovìdi od webové slu¾by. Vytvoøená vlákna jsou instancí stejné tøídy pouze pro zpracování odpovìdi mají vymìnìné deskriptory pro spojení. Spojení je realizováno schránkami (sockets). Vytvoøená vlákna mají za úkol oddìlit obsah od hlavièky a odeslat po¾adovaná data do injektoru poruch. Injektor poruch provede analýzu HTTP zprávy a podle zadaných podmínek provedou patøiènou deformaci dat - injekci chyby.

 



\subsection*{Grafické u¾ivatelské rozhraní}
Grafické u¾ivatelské rozhraní je vytvoøeno v sadì nástrojù Swing. Na obrázku .. je vidìt základní rozlo¾ení GUI. Na pravé stranì je navigaèní panel, který zobrazuje obsah koøenového adresáøe. Ve spodní èásti je mo¾no vidìt konzolu, kam se zapisují vygenerované zprávy nástroje. Zbytek plochy je hlavní panel.

V GUI je se v¹emi daty zacházeno jako s instancemi jejich tøíd. Tedy v rámci GUI nedochází k ¾ádným datovým operacím. V¹echna data jsou odesílána do kontroléru, který je pøedá k zápisu. Pokud si GUI vy¾ádá data, kontrolér zajistí jejich pøeètení a pøedá je danému panelu. 

Pøi zobrazování výsledkù testù jsou zobrazovací panel spojen s pøíslu¹nou aplikaèní jednotkou a pøijímá výsledky testù pøímo bez akce kontroléru. Delegaci komunikace z aplikaèní jednotky do zobrazovacího panelu zaji¹»ují instance tøíd {\it TestPanelListener } a {\it ProxyPanelListener }. Tyto instance pøijímají data od aplikaèní jednotky a odesílají je do zobrazovacího panelu. Tento zpùsob delegace byl zvolen kvùli distribuované architektuøe. Metody delegaèních instancí jsou volány ze vzdálených aplikaèních jednotek, a proto je vhodné tyto komunikaèní operace oddìlit od metod GUI.

Základní funkce GUI jsou k dispozici v polo¾kách menu {\it File} a {\it View}. Polo¾ka  {\it File} obsahuje pøíkazy pro vytvoøení kompletního schématu dat. Navíc pak obsahuje pøíkazy pro otevøení  {\it Open}), smazání ({\it Delete}), obnovu navigaèního panelu ({\it Refresh}) a ukonèení nástroje ({\it Exit}). Polo¾ka  {\it View} pak nabízí pøíkazy pro pøepínání jednotlivých hlavních panelù GUI.

Navigaèní panel je tvoøen tøídou {\it Navigator}, která umo¾òuje vyvolání kontextového menu pro intuitivnìj¹í pou¾ití. Pomocí kontextového menu je mo¾no otevírat jednotlivé hlavní panely podle toho, na kterou polo¾ku ve struktuøe bylo kliknuto. Pøi vytváøení nových polo¾e je nutno nejdøíve vybrat polo¾ku nadøazeného prvku viz obrázek. Jedinou výjimkou je vytvoøení testovací sady, proto¾e je hierarchicky nejvý¹e a nemá nadøazený prvek. Pokud se u¾ivatel pokusí vytvoøit polo¾ku bez vybrání nadøazeného prvku, bude do konzole vypsána patøièná hlá¹ka. V pøípadì testovacího pøípadu jej nebude mo¾né vytvoøit bez oznaèení testovací sady, do které má být vytvoøen.

%\newpage
\begin{figure}[h]
\begin{center}
 \includegraphics[scale=0.42]{pic/http.jpg}
\caption{Náhled vytvoøení HTTP po¾adavku. }
\label{fig:vrstvy}
\end{center}
\end{figure}
\noindent Grafické u¾ivatelské prostøedí má tøi hlavní panely:

\subsubsection*{Panel editoru}
Panel editoru je rozdìlen na sekce pro editování nastavení testu, HTTP po¾adavku a injekce chyb. V sekci pro editaci HTTP po¾adavku je mo¾né vygenerovat SOAP po¾adavek podle pøedlo¾eného WSDL dokumentu. Pro generování SOAP po¾adavku bylo pou¾ito experimentální knihovny {\it soap-builder}. Dále je mo¾no vlo¾it oèekávanou odpovìï, aby bylo mo¾né vyhodnotit test. Vyhodnocování je mo¾né pro XML vstupy. Pøi otevøení editoru se v¾dy naètou v¹echny èásti a zobrazí se pøíslu¹ná sekce. Pøi otevøení testu se jméno zobrazí v záhlaví dané sekce.
\subsubsection*{Testovací panel}
Testovací panel je hlavní zobrazovací panel aplikace, odkud se ovládá spou¹tìní testovacích po¾adavkù a jejich vyhodnocení. Panel obsahuje li¹tu s pøíkazy pro ovládání aplikace, tabulku pro testovací pøípady, tabulku pro výsledky testù a panely pro zobrazení obsahu odpovìdí. 
Pomocí kontextového menu v navigaèním panelu nebo panelu nástrojù je mo¾né pøidávat testovací pøípady do tabulky. Obsah tabulky je mo¾né ulo¾it jako seznam testù do souboru {\it testlist.xml}. V druhé tabulce jsou zobrazeny pouze výsledky pro jeden test. 

Pøíjem od aplikaèní jednotky je realizován metodou {\it onNewMessageEvent}, kde probìhne ulo¾ení dat do ADT \footnote{abstraktní datový typ} {\it HahsMap}. Pro první testovací pøípad jsou data zobrazována v reálném èase. Pro ostatní testovací pøípady jsou data ulo¾eny v tabulce a zobrazovány na vy¾ádání u¾ivatele.

Pro distribuovaný test je potøeba pøipojit dal¹í aplikaèní jednotky a jejich zobrazovací panely k centrálnímu GUI. Tato operace se provede pøíkazem {\it Add Remote Unit}. Pøedpoklad pro pøipojení dal¹í aplikaèní jednotky je spu¹tìný RMI server na vzdálené stranì. Po zadání údajù do formuláøe je pøidána dal¹í sekce se zobrazovacím panelem.  Po naètení dat do v¹ech jednotek je distribuovaný test spu¹tìn pøíkazem  {\it Run All Units}. Jednotlivá data jsou pøedána kontroléru, který je roze¹le vzdáleným jednotkám, spustí testování  a komunikace ji¾ probíhá mezi aplikaèními jednotkami a zobrazovacími panely v centrálním GUI.

Na panelu nástrojù je vytvoøena je¹tì funkce pro export konfigurace distribuované ho testu. Tento export ulo¾í údaje o spojení k vzdáleným strojùm do souboru. Pak je mo¾né pomocí importu konfigurace pøipojit vzdálené stroje pomocí jednoho pøíkazu. Hlavním dùvodem exportu konfigurace je v¹ak mo¾nost distribuovaného testu z pøíkazové øádky. Pro pøipojení vzdálených strojù pøi spu¹tìní testu z pøíkazové øádky bude pou¾ito právì exportované konfigurace. Pro ulo¾ení tìchto dat byla pou¾ita knihovna {\it ini4j}. Tato knihovna slou¾í k ukládání dat ve formátu {\it ini}. Tento formát byl zvolen kvùli jednoduchosti jeho pøípadné editace u¾ivatelem nebo jeho vytvoøení bez pou¾ití GUI.
\subsubsection*{Panel proxy monitoru}

V zobrazovacím panelu proxy monitorovací jednotky bylo provedeno jen nìkolik zmìn. Proxy monitorovací jednotku lze spustit i samostatnì bez pøítomnosti testovací jednotky. Je nutno oznaèit test v navigaèním panelu a spustit jednotku. Samostatnì lze spou¹tìt i proxy jednotky na vzdálených strojích. Uplatní se stejný postup, který je popsán v pøedchozím odstavci pro testovací jednotku. Proxy jednotky nelze spou¹tìt hromadnì, musí se spustit ka¾dá zvlá¹».
\begin{figure}[h]
\begin{center}
 \includegraphics[scale=0.42]{pic/proxyunit.jpg}
\caption{Náhled zobrazení proxy jednotky. }
\label{fig:vrstvy}
\end{center}
\end{figure}

\subsection*{Rozhraní pøíkazové øádky}
Rozhraní pøíkazové øádky je fakticky hlavním rozhraním celého nástroje. Nástroj je mo¾né spustit pouze z pøíkazové øádky. Av¹ak je mo¾né pou¾ít skriptovací nástroje jako je Bash v OS Linux nebo dávku .bat v pøípadì OS Windows.  Pro rozpoznání jednotlivých pøíkazù a jejich parametrù byla pou¾ita knihovna {\it Apache Commons CLI}.
\\\\
\noindent Nástroj disponuje tìmito pøíkazy:

\begin{center}
\begin{tabular}{| l | l| }
\hline
-h &    Zobrazení nápovìdy \\ \hline

-g & Spu¹tìní grafického u¾ivatelského rozhraní\\ \hline

-r & Spu¹tìní RMI serveru \\ \hline

-testlist  \textless  soubor\textgreater ~[-config  \textless soubor\textgreater] & Spu¹tìní  testu, \\ &  spu¹tìní distribuovaného testu \\ \hline

-r & Spu¹tìní RMI serveru \\ \hline


-proxy \textless soubor\textgreater ~[-config  \textless soubor\textgreater]  & Spu¹tìní proxy jednotky, \\ & spu¹tìní více proxy jednotek \\  \hline

-stopproxy ~[-config  \textless soubor\textgreater] & Zastavení proxy jednotky, \\ & zastavení v¹ech proxy jednotek \\ 

-proxy \textless soubor\textgreater ~[-config  \textless soubor\textgreater]  & Spu¹tìní proxy jednotky, \\ & spu¹tìní více proxy jednotek \\  \hline


\hline
\end{tabular}
\end{center}


\noindent  Ovládání z pøíkazové øádky bylo vytvoøeno stejným principem jako GUI. Tedy pøi zadání pøíkazu jsou data naètena a pøedána kontroléru. Tento pøístup je mo¾ný díky architektuøe vrstev, kdy u¾ivatelská rozhraní pouze pou¾ívají mo¾nosti kontroléru a v¹echny úkony se provádìjí pøes jednotné rozhraní. Ovládání z pøíkazové øádky nemá zobrazovací panel, ale má instanci tøídy {\it TextMonitor}, která pøijímá data od aplikaèních jednotek a odesílá je do ni¾¹ích vrstev k ulo¾ení do souboru na disku. 

Pro spu¹tìní distribuovaného testu je tøeba pøidat nepovinný parametr {\it -config} se umístìním souboru konfigurace pøipojení vzdálených strojù. Nejdøíve se vytvoøí pøipojení ke vzdáleným strojùm, pak se ode¹lou testovací data a ode¹le se pøíkaz ke spu¹tìní testu na v¹ech jednotkách.  Pokud se není parametr s umístìním konfigurace pøítomen, spustí se test  pouze v aplikaèních jednotkách, které jsou souèástí lokálního programu.

Výstupem testù pøi ovládání z pøíkazové øádky jsou soubory v adresáøi {\it Output} ka¾dého testovacího pøípadu. Ka¾dý výsledek testovacího pøípadu vygeneruje soubor s meta daty a obsah Http odpovìdi, která byla pøijata. 

\section{Integrace s pøedchozím øe¹ením}
V této èásti je popsáno jaký postup byl zvolen pro navázání na pøedchozí práci. Implementace GUI pøedchozí práce byla tìsnì vázána na testovací data, která byla souèástí GUI a následnì se ulo¾ila na disk. Pøi spu¹tìní proxy jednotky se vyu¾ila data z GUI namísto ulo¾ená na disku, kdy tak docházelo k ne¾ádoucímu svázání dat s bì¾ící proxy jednotkou. Tato implementace byla zmìnìna. Nyní se ve¹kerá vytvoøená data ukládají na disk. Z disku je zprostøedkovatel na pøíkaz kontroléru pøeète a instance objektu je pøedána aplikaèní jednotce. Tento zpùsob byl zvolen hlavnì z dùvodù oddìlení jednotlivých èástí do vrstev a následné implementaci distribuované architektury.


Dále pak v pùvodní implementaci mìla proxy jednotka za úkol monitoring pøíchozích spojení a vytvoøení vláken pro obsluhu spojení. Ve¹kerou implementaci pro zobrazování dat mìl v sobì integrovaný kontrolér. Tato funkcionalita byla pøesunuta do proxy jednotky. Mù¾e se zdát, ¾e tato funkcionalita by nemìla být souèástí proxy jednotky. Toto je v¹ak úèelné, proto¾e pøesunutí registrace zobrazovacích panelù do aplikaèních jednotek má cíl oddìlení registrace od lokální èásti aplikace. Takto upravená implementace jednotky mù¾e být spu¹tìná na vzdáleném stroji a zaregistrovat zobrazovací panel pomocí RMI metod.



\section{Vylep¹ení injekce chyb}
V této èásti 
\subsection*{Podpora dal¹ích datových reprezentací }
asdfasdf

\subsection*{Pøidání dal¹ích typù injekcí chyb a jejich podmínek}
asdfasdf

\newpage


\section{Mo¾nost integrace s testovacími nástroji}
Mo¾nost integrování s testovacími nástroji vychází z pou¾ití rozhraní pøíkazové øádky. Pro integraci s dal¹ími testovacími nástroji je mo¾né pou¾ít nástroj Apache Ant, který disponuje mo¾ností spou¹tìt externí programy pomocí pøíkazové øádky. Pøi vhodné kombinaci konfigurace pøipojení a vytvoøených seznamù testovacích pøípadù je mo¾né pou¾ít vytvoøený nástroj s dal¹ími.




\section{Implementace distribuované architektury}
Tato sekce je zamìøena na detaily implementace distribuované architektury vytvoøeného nástroje. Pro implementaci spojení mezi jednotlivými vzdálenými stroji byl vybrána technologie Java RMI. Nynìj¹í implementace Java RMI splòuje standard CORBA. Pøi dodr¾ení rozhraní lze komunikovat se vzdálenou stranou, která je implementována jinou technologii(C++, Python apod.). Java RMI je technologie umo¾òující volání metod objektù, které jsou umístìny na vzdáleném stroji. Princip je zobrazen na obrázku .. . Staèí tedy spustit RMI server a registrovat objekt. Po¾adovaný objekt je zaregistrován v registru. Registr je mo¾né kontaktovat a vy¾ádat si rozhraní daného objektu.

Na obrázku \ref{fig:dismodel}. je zobrazena implementace distribuované architektury vytvoøeného nástroje. Vzdálené stroje jsou implementovány jako RMI server a ka¾dý server musí mít vlastní registr. Centrální GUI tedy plni roli klienta. V tomto pøípadì jsou instance vzdálených aplikaèních jednotek uchovány v ADT {\it HashMap}. Jednotlivé instance jsou spárovány se zobrazovacím panelem identifikaèním èíslem. Pøi interpretaci pøíkazu z GUI je získáno identifikaèní èíslo z hlavièky panelu. Identifikaèní èíslo je pak pou¾ito jako klíè k vyhledání správné aplikaèní jednotky. Po získání instance aplikaèní jednotky je pøíkaz odeslán.

\begin{figure}[h]
\begin{center}
 \includegraphics[scale=0.7]{pic/dismodel.png}
\caption{Náhled zobrazení proxy jednotky. }
\label{fig:distmodel}
\end{center}
\end{figure}

\chapter{Prùbìh testování webových slu¾eb}
\section{Sledované parametry}
sdafsadf
\section{Testování webových slu¾eb s  dostupným zdrojovým kódem}
asdfadf
\section{Testování veøejnì dostupných slu¾eb}
asdfadf
\newpage
\chapter{Závìr}
dsafasdf
\section{Mo¾nosti dal¹ího vývoje}
sdfsdf

%=========================================================================
